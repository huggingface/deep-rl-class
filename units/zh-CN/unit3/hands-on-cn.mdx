# åŠ¨æ‰‹å°è¯• [[hands-on]]



      <CourseFloatingBanner classNames="absolute z-10 right-0 top-0"
      notebooks={[
        {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/deep-rl-class/blob/main/notebooks/unit3/unit3.ipynb"}
        ]}
        askForHelpUrl="http://hf.co/join/discord" />

ç°åœ¨ä½ å·²ç»å­¦ä¹ äº†æ·±åº¦ Q-Learning èƒŒåçš„ç†è®ºï¼Œ**ä½ å·²ç»å‡†å¤‡å¥½è®­ç»ƒä½ çš„æ·±åº¦ Q-Learning æ™ºèƒ½ä½“å»ç© Atari æ¸¸æˆäº†**ã€‚æˆ‘ä»¬å°†ä»ç©ºé—´å…¥ä¾µå¼€å§‹ï¼Œä½†æ˜¯ä½ å¯ä»¥ç”¨åœ¨ä»»ä½•ä½ æƒ³è¦çš„ Atari æ¸¸æˆé‡Œ ğŸ”¥ã€‚


<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit4/atari-envs.gif" alt="Environments"/>

æˆ‘ä»¬ä½¿ç”¨çš„[RL-Baselines-3 Zoo é›†æˆ](https://github.com/DLR-RM/rl-baselines3-zoo), ä¸€ä¸ªæ·±åº¦ Q-learning çš„åŸºç¡€ç‰ˆæœ¬ï¼Œæ²¡æœ‰åƒåŒé‡-DQN ï¼Œç«äº‰â€”DQN æˆ–è€…ä¼˜å…ˆç»éªŒé‡æ¼”çš„æ‰©å±•ã€‚

åŒæ ·å¦‚æœåœ¨æœ¬æ¬¡åŠ¨æ‰‹å°è¯•åä½ äº²è‡ªæƒ³äº†è§£æ‰§è¡Œæ·±åº¦ Q-Learningã€‚ä½ ä¸€å®šè¦çœ‹ä¸€çœ‹ CleanRL çš„æ‰§è¡Œï¼šhttps://github.com/vwxyzjn/cleanrl/blob/master/cleanrl/dqn_atari.py

ä¸ºäº†å¯¹æ­¤æ¬¡åŠ¨æ‰‹å°è¯•è¿›è¡Œè®¤è¯ï¼Œä½ éœ€è¦æŠŠä½ çš„è®­ç»ƒå¥½çš„æ¨¡å‹æ¨é€åˆ° Hub ä¸Šå¹¶ä¸”**è·å¾— >=200 çš„ç»“æœ**ã€‚

è¦æ‰¾åˆ°ä½ çš„ç»“æœï¼Œå» leaderboaed é‡Œé¢æ‰¾ä½ çš„æ¨¡å‹ï¼Œ **å…¶ç»“æœ=å¹³å‡å¥–åŠ±-æ ‡å‡†å·®å¥–åŠ±**

å…³äºè®¤è¯ä¿¡æ¯çš„æ›´å¤šè¿‡ç¨‹è¯·æŸ¥çœ‹è¿™ä¸ªéƒ¨åˆ† ğŸ‘‰ https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process

ä½ å¯ä»¥åœ¨è¿™æŸ¥çœ‹è¿›ç¨‹ ğŸ‘‰ https://huggingface.co/spaces/ThomasSimonini/Check-my-progress-Deep-RL-Course


**ç‚¹å‡»ä¸‹æ–¹å¼€å§‹å°è¯•æœ¬æ¬¡å®éªŒ** ğŸ‘‡ :

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/huggingface/deep-rl-class/blob/master/notebooks/unit3/unit3.ipynb)


# Unit 3: ç”¨ RL Baselines3 Zoo è¿›è¡Œæ·±åº¦ Q-Learning å’Œ Atari æ¸¸æˆ ğŸ‘¾  

<img src="https://raw.githubusercontent.com/innovation64/Picimg/main/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20230222150251.jpg" alt="Unit 3 Thumbnail">

åœ¨ç¬”è®°ä¸­ï¼Œä½ å°†ä½¿ç”¨ [RL Baselines3 Zoo](https://github.com/DLR-RM/rl-baselines3-zoo) ,ä¸€ä¸ªåŸºäº [Stable-Baselines3](https://stable-baselines3.readthedocs.io/en/master/) çš„è®­ç»ƒæ¡†æ¶å…¶å¯ä»¥ä½¿ç”¨è„šæœ¬å»è®­ç»ƒï¼Œè¯„ä¼°è°ƒæ•´è¶…å‚æ•°å›¾ç¤ºç»“æœå’Œè§†é¢‘è®°å½•ï¼Œè®­ç»ƒä¸€ä¸ªæ·±åº¦ Q-Learning æ™ºèƒ½ä½“å»ç©ç©ºé—´å…¥ä¾µæ¸¸æˆã€‚

æˆ‘ä»¬ä½¿ç”¨ [RL-Baselines-3 Zoo é›†æˆ, æ·±åº¦ Q-Learning çš„åŸå§‹ç‰ˆæœ¬](https://stable-baselines3.readthedocs.io/en/master/modules/dqn.html) å…¶ä¸åŒ…å«åƒåŒé‡ DQNï¼Œç«äº‰-DQN å’Œä¼˜å…ˆç»éªŒé‡æ¼”çš„æ‰©å……ã€‚

â¬‡ï¸ è¿™æ˜¯ä½ å°†è¦**è¾¾æˆæ•ˆæœ**çš„ä¾‹å­ â¬‡ï¸

```python
%%html
<video controls autoplay><source src="https://huggingface.co/ThomasSimonini/ppo-SpaceInvadersNoFrameskip-v4/resolve/main/replay.mp4" type="video/mp4"></video>
```

### ğŸ® ç¯å¢ƒï¼š

- SpacesInvadersNoFrameskip-v4

### ğŸ“š RL-åº“:

- [RL-Baselines3-Zoo](https://github.com/DLR-RM/rl-baselines3-zoo)

## ç›®æ ‡ ğŸ†

åœ¨æœ¬ç¬”è®°ç»“æŸï¼Œä½ å°†ä¼šå¾—åˆ°ï¼š

- èƒ½å¤Ÿå¯¹  **RL Baselines3 Zoo æ€ä¹ˆè¿ä½œ**æœ‰æ›´æ·±çš„ç†è§£ã€‚
- èƒ½å¤ŸæŠŠä½ è®­ç»ƒçš„æ™ºèƒ½ä½“å’Œä»£ç æ¨é€åˆ° Hub ä¸Šå¹¶å±•ç¤ºä¸€ä¸ªä¸é”™çš„è§†é¢‘æ•ˆæœå’Œè¯„ä¼°åˆ†æ•° ğŸ”¥ã€‚


## å‰ç½®å‡†å¤‡ ğŸ—ï¸
åœ¨è¿›å…¥æœ¬ç¬”è®°å‰ï¼Œä½ éœ€è¦ï¼š

ğŸ”² ğŸ“š **[å­¦ä¹  Unit 3 çš„æ·±åº¦ Q-Learning ](https://huggingface.co/deep-rl-course/unit3/introduction)**  ğŸ¤—

æˆ‘ä»¬ä¼šæŒç»­æå‡æˆ‘ä»¬çš„æ•™ç¨‹è´¨é‡ï¼Œå¦‚æœä½ åœ¨æœ¬ç¬”è®°ä¸­å‘ç°äº†ä»€ä¹ˆé—®é¢˜è¯· [åœ¨ Github Repo ä¸Šæå‡º issue](https://github.com/huggingface/deep-rl-class/issues).

# è®©æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªæ·±åº¦ Q-Learning æ™ºèƒ½ä½“å»ç© Atari ç©ºé—´å…¥ä¾µ ğŸ‘¾ å¹¶æŠŠä»–ä¸Šä¼ åˆ° Hubã€‚

## è®¾ç½® GPU ğŸ’ª

- ä¸ºäº† **åŠ é€Ÿæ™ºèƒ½ä½“çš„è®­ç»ƒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ GPU**. ç‚¹å‡» `Runtime > Change Runtime type`

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/gpu-step1.jpg" alt="GPU Step 1">

- `Hardware Accelerator > GPU`

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/gpu-step2.jpg" alt="GPU Step 2">

## åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿæ˜¾ç¤º ğŸ”½

åœ¨ç¬”è®°ä¸­, æˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ªé‡æ¼”è§†é¢‘ã€‚åœ¨ colab ä¸­ï¼Œ**æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè™šæ‹Ÿå±å¹•å»æ¸²æŸ“ç¯å¢ƒ**ï¼ˆå¹¶è®°å½•å¸§ï¼‰ã€‚

æ‰€ä»¥å‚ç…§ä¸‹é¢å•å…ƒæ ¼å®‰è£…ç›¸å…³åº“å¹¶è¿è¡Œè™šæ‹Ÿå±å¹• ğŸ–¥

```bash
apt install python-opengl
apt install ffmpeg
apt install xvfb
pip3 install pyvirtualdisplay
```

```bash
apt-get install swig cmake freeglut3-dev
```

```bash
pip install pyglet==1.5.1
```

```python
# Virtual display
from pyvirtualdisplay import Display

virtual_display = Display(visible=0, size=(1400, 900))
virtual_display.start()
```

## æ‹·è´ RL-Baselines3 Zoo ä»“åº“ ğŸ“š
ä½ å¯ä»¥ç›´æ¥ä» Python åŒ… (`pip install rl_zoo3`) å®‰è£…,ä½†æ˜¯æƒ³è¦**å¸¦æœ‰é¢å¤–ç¯å¢ƒå’Œä¾èµ–çš„å…¨å®‰è£…**ï¼Œæˆ‘ä»¬éœ€è¦æ‹·è´ `RL-Baselines3-Zoo` ä»“åº“å¹¶ä»æºç å®‰è£…ã€‚

```bash
git clone https://github.com/DLR-RM/rl-baselines3-zoo
```

## å®‰è£…ä¾èµ– ğŸ”½
æˆ‘ä»¬ç°åœ¨å¯ä»¥å®‰è£… RL-Baselines3 Zoo éœ€è¦çš„ä¾èµ– (è¿™å¤§æ¦‚æŒç»­ 5min â²)

```bash
cd /content/rl-baselines3-zoo/
```

```bash
pip install -r requirements.txt
```

## è®­ç»ƒæˆ‘ä»¬çš„æ·±åº¦ Q-Learning æ™ºèƒ½ä½“å»ç©ç©ºé—´å…¥ä¾µ ğŸ‘¾

è¦ç”¨ RL-Baselines3-Zoo è®­ç»ƒæ™ºèƒ½ä½“ï¼Œæˆ‘ä»¬ä»…éœ€åšä¸¤ä»¶äº‹ï¼š
1. åœ¨ `rl-baselines3-zoo/hyperparams/dqn.yml` é‡Œå®šä¹‰è¶…å‚æ•°

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/unit3/hyperparameters.png" alt="DQN Hyperparameters">


æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š
- ä½¿ç”¨ `Atari Wrapper` è¿›è¡Œé¢„åŠ è½½ (ç¼©å‡å¸§, ç°åº¦, å †å å››å¸§),
- ä½¿ç”¨ `CnnPolicy`, ç”¨å·ç§¯å±‚åŠ è½½å¸§ã€‚
- æˆ‘ä»¬ç”¨ä¸€åƒä¸‡ `n_timesteps` è®­ç»ƒæ¨¡å‹ã€‚
- å†…å­˜å¤§å° (ç»éªŒé‡æ¼”) å¤§å°æ˜¯ 100000 ,ä¹Ÿå°±æ˜¯ä½ ä¿å­˜çš„ç»éªŒæ­¥æ•°é‡å†æ¬¡è®­ç»ƒæ™ºèƒ½ä½“ã€‚

ğŸ’¡ æˆ‘çš„å»ºè®®æ˜¯**å‡å°‘è®­ç»ƒçš„æ—¶é—´æ­¥åˆ° 1M**ï¼Œè¿™å¤§æ¦‚åœ¨ P100 çš„æœºå™¨ä¸ŠèŠ± 90minã€‚ `!nvidia-smi` å‘½ä»¤ä¼šæ˜¾ç¤ºä½ çš„GPUè¿è¡Œæƒ…å†µã€‚åœ¨ä¸€åƒä¸‡æ­¥ä¸‹,ä»–å°†èŠ± 9 ä¸ªå°æ—¶ ï¼Œè¿™æœ‰å¯èƒ½å¯¼è‡´ Coblab è¶…æ—¶ã€‚è¿™é‡Œå»ºè®®ä½ åœ¨ä½ æœ¬åœ°çš„æœºå­ï¼ˆæˆ–å…¶ä»–ï¼‰ä¸Šé¢è·‘ä»£ç ï¼Œåªéœ€è¦ç‚¹å‡»ï¼š `File>Download`ã€‚

ä¸ºäº†ä¼˜åŒ–è¶…å‚æ•°ï¼Œæˆ‘çš„å»ºè®®æ˜¯èšç„¦ä¸‹é¢ä¸‰ä¸ªè¶…å‚æ•°ï¼š
- `learning_rate`
- `buffer_size (Experience Memory size)`
- `batch_size`

ç»éªŒå‘Šè¯‰æˆ‘ä»¬, ä½ éœ€è¦**æ£€æŸ¥æ–‡æ¡£å¹¶ç†è§£æ¯ä¸ªè¶…å‚æ•°çš„æ„ä¹‰**ï¼š https://stable-baselines3.readthedocs.io/en/master/modules/dqn.html#parameters



2. è¿è¡Œ `train.py` å¹¶æŠŠæ¨¡å‹ä¿å­˜åœ¨ `logs` æ–‡ä»¶å¤¹ ğŸ“

```bash
python train.py --algo ________ --env SpaceInvadersNoFrameskip-v4  -f _________
```

#### è§£å†³æ–¹æ¡ˆ

```bash
python train.py --algo dqn  --env SpaceInvadersNoFrameskip-v4 -f logs/
```

## è®©æˆ‘ä»¬è¯„ä¼°æˆ‘ä»¬çš„æ™ºèƒ½ä½“ ğŸ‘€
- RL-Baselines3-Zoo æä¾› `enjoy.py` æ–‡ä»¶, ä¸€ä¸ªè¯„ä¼°æ™ºèƒ½ä½“çš„ python è„šæœ¬ã€‚åœ¨å¤§å¤šæ•° RL åº“ä¸­ï¼Œæˆ‘ä»¬éƒ½æŠŠè¯„ä¼°è„šæœ¬å«åš `enjoy.py`.
- è®©æˆ‘ä»¬ç”¨ 5000 æ­¥è¯„ä¼°ä¸€ä¸‹  ğŸ”¥

```bash
python enjoy.py  --algo dqn  --env SpaceInvadersNoFrameskip-v4  --no-render  --n-timesteps _________  --folder logs/
```

#### è§£å†³æ–¹æ¡ˆ

```bash
python enjoy.py  --algo dqn  --env SpaceInvadersNoFrameskip-v4  --no-render  --n-timesteps 5000  --folder logs/
```

## æŠŠæˆ‘ä»¬è®­ç»ƒçš„æ¨¡å‹å‘å¸ƒåœ¨ Hub ä¸Š ğŸš€
ç°åœ¨ç»è¿‡è®­ç»ƒåæˆ‘ä»¬å¾—åˆ°äº†ä¸é”™çš„åˆ†æ•°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸€è¡Œä»£ç å°†æˆ‘ä»¬è®­ç»ƒçš„æ¨¡å‹å‘å¸ƒåˆ° Hub ä¸Šã€‚

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/unit3/space-invaders-model.gif" alt="Space Invaders model">

ä½¿ç”¨ `rl_zoo3.push_to_hub.py`, **ä½ è¯„ä¼°è®°å½•é‡æ¼”ï¼Œç”Ÿæˆäº†ä½ æ™ºèƒ½ä½“çš„æ¨¡å‹å¡ï¼Œå¹¶æŠŠä»–æ¨é€åˆ°äº† Hub**ã€‚

è¿™è¾¹ï¼š
- ä½ å¯ä»¥ **å±•ç¤ºæˆ‘ä»¬çš„å·¥ä½œ** ğŸ”¥
- ä½ å¯ä»¥ **å¯è§†åŒ–ä½ çš„æ™ºèƒ½ä½“è¿è¡Œ** ğŸ‘€
- ä½ å¯ä»¥ **åœ¨ç¤¾åŒºåˆ†äº«ä¸€ä¸ªä»–äººå¯ç”¨çš„æ™ºèƒ½ä½“** ğŸ’¾
- ä½ å¯ä»¥ **è·å– leaderboard ğŸ† å’Œä½ çš„åŒå­¦å¯¹æ¯”æŸ¥çœ‹ä½ çš„æ™ºèƒ½ä½“çš„è¡¨ç°æ€§èƒ½** ğŸ‘‰  https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard

ä¸ºäº†å°†ä½ çš„æ¨¡å‹åˆ†äº«åˆ°ç¤¾åŒºï¼Œä½ éœ€è¦éµå¾ªä¸‹é¢æ­¥éª¤ï¼š

1ï¸âƒ£ (å¦‚æœè¿˜æ²¡åš) åœ¨ HF åˆ›å»ºä¸€ä¸ªè´¦å· â¡ https://huggingface.co/join

2ï¸âƒ£ ç™»å½• HF è·å–ä½ çš„è®¤è¯ token ã€‚
- åˆ›å»º**å¸¦æœ‰å†™æƒé™**çš„æ–°çš„ token (https://huggingface.co/settings/tokens) 

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/create-token.jpg" alt="Create HF Token">

- å¤åˆ¶ token
- è¿è¡Œä¸‹é¢å•å…ƒæ ¼å¹¶ç²˜è´´ token

```python
from huggingface_hub import notebook_login # To log to our Hugging Face account to be able to upload models to the Hub.
notebook_login()
git config --global credential.helper store
```

å¦‚æœä½ ä¸æƒ³ä½¿ç”¨ Google Colab æˆ–è€… Jupyter Notebookï¼Œä½ éœ€è¦ç”¨è¿™ä¸ªå‘½ä»¤ä»£æ›¿ï¼š`huggingface-cli login`

3ï¸âƒ£ æˆ‘ä»¬ç°åœ¨å·²ç»å‡†å¤‡å¥½æ¨é€ä½ çš„æ™ºèƒ½ä½“åˆ° Hub äº† ğŸ”¥

è®©æˆ‘ä»¬è¿è¡Œ `push_to_hub.py` å»ä¸Šä¼ æˆ‘ä»¬è®­ç»ƒçš„æ™ºèƒ½ä½“åˆ° Hubã€‚è¿™é‡Œæœ‰ä¸¤ä¸ªé‡è¦å‚æ•°:

* `--repo-name `: ä»“åº“å
* `-orga`: ä½ çš„ Hugging Face ç”¨æˆ·å

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/unit3/select-id.png" alt="Select Id">

```bash
python -m rl_zoo3.push_to_hub  --algo dqn  --env SpaceInvadersNoFrameskip-v4  --repo-name _____________________ -orga _____________________ -f logs/
```

#### è§£å†³æ–¹æ¡ˆ

```bash
python -m rl_zoo3.push_to_hub  --algo dqn  --env SpaceInvadersNoFrameskip-v4  --repo-name dqn-SpaceInvadersNoFrameskip-v4  -orga ThomasSimonini  -f logs/
```

æ­å–œ ğŸ¥³ ä½ å·²ç»å®Œæˆè®­ç»ƒå¹¶ä¸Šä¼ äº†ä½ çš„ç¬¬ä¸€ä¸ªç”¨ RL-Baselines-3 Zoo çš„æ·±åº¦ Q-Learning æ™ºèƒ½ä½“ã€‚ä¸Šé¢çš„è„šæœ¬å·²ç»å±•ç¤ºäº†ä¸€ä¸ªæ¨¡å‹ä»“åº“çš„é“¾æ¥åƒ https://huggingface.co/ThomasSimonini/dqn-SpaceInvadersNoFrameskip-v4ã€‚å½“ä½ ç‚¹å‡»è¿™ä¸ªé“¾æ¥ï¼Œä½ å¯ä»¥ï¼š

- åœ¨å³è¾¹çœ‹è§ä½ **æ™ºèƒ½ä½“çš„é¢„è§ˆ**ã€‚
- ç‚¹å‡» "Files and versions" æŸ¥çœ‹æ‰€æœ‰ä»“åº“ä¸­çš„æ–‡ä»¶ã€‚
- ç‚¹å‡» "Use in stable-baselines3" è·å–æ€ä¹ˆåŠ è½½æ¨¡å‹çš„ä»£ç ç‰‡æ®µã€‚
- æ¨¡å‹å¡ (`README.md` æ–‡ä»¶) æè¿°äº†æ¨¡å‹å’Œä½ ä½¿ç”¨çš„è¶…å‚æ•°ã€‚

åº•å±‚çœ‹ï¼ŒHub ä½¿ç”¨åŸºäº git çš„ä»“åº“ï¼ˆå¦‚æœä½ ä¸çŸ¥é“å•¥æ˜¯ git ï¼Œåˆ«æ‹…å¿ƒï¼‰ã€‚è¿™æ„å‘³è¿™ä½ å¯ä»¥æ›´æ–°ç‰ˆæœ¬å¹¶æå‡ä½ çš„æ™ºèƒ½ä½“æ¨¡å‹ã€‚

**å’Œä½ çš„åŒä¼´æ¯”è¾ƒä¸€ä¸‹ç»“æœ** ä½¿ç”¨ [leaderboard](https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard) ğŸ†

## åŠ è½½ä¸€ä¸ªä¼˜ç§€çš„è®­ç»ƒå¥½çš„æ¨¡å‹ ğŸ”¥

Stable-Baselines3 å›¢é˜Ÿåœ¨ Hub ä¸Š**ä¸Šä¼ äº†è¶…è¿‡ 150 ç»™è®­ç»ƒå¥½çš„æ·±åº¦å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“**ã€‚ä½ å¯ä»¥ä¸‹è½½å¹¶è§‚å¯Ÿä»–ä»¬æ€ä¹ˆè¿è¡Œï¼

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ä»–ä»¬ï¼šğŸ‘‰ https://huggingface.co/sb3

ä¸€äº›ä¾‹å­ï¼š
- Asteroids: https://huggingface.co/sb3/dqn-AsteroidsNoFrameskip-v4
- Beam Rider: https://huggingface.co/sb3/dqn-BeamRiderNoFrameskip-v4
- Breakout: https://huggingface.co/sb3/dqn-BreakoutNoFrameskip-v4
- Road Runner: https://huggingface.co/sb3/dqn-RoadRunnerNoFrameskip-v4

è®©æˆ‘ä»¬åŠ è½½ä¸€ä¸ªæ™ºèƒ½ä½“å»ç© Beam Rider: https://huggingface.co/sb3/dqn-BeamRiderNoFrameskip-v4

```python
<video controls autoplay><source src="https://huggingface.co/sb3/dqn-BeamRiderNoFrameskip-v4/resolve/main/replay.mp4" type="video/mp4"></video>
```

1. æˆ‘ä»¬ä½¿ç”¨ `rl_zoo3.load_from_hub` ä¸‹è½½æ¨¡å‹, ç„¶åæŠŠä»–æ”¾åˆ° `rl_trained` çš„æ–°æ–‡ä»¶å¤¹é‡Œ

```bash
# Download model and save it into the logs/ folder
python -m rl_zoo3.load_from_hub --algo dqn --env BeamRiderNoFrameskip-v4 -orga sb3 -f rl_trained/
```

2. è®©æˆ‘ä»¬è¿è¡Œ 5000 æ­¥è¯„ä¼°ä¸€ä¸‹

```bash
python enjoy.py --algo dqn --env BeamRiderNoFrameskip-v4 -n 5000  -f rl_trained/
```

ä¸ºå•¥ä¸è¯•ç€è®­ç»ƒä¸€ä¸‹ä½ è‡ªå·±çš„**æ·±åº¦ Q-Learning æ™ºèƒ½ä½“å»ç© BeamRiderNoFrameskip-v4? ğŸ†.**

å¦‚æœä½ æƒ³å°è¯•, æŸ¥çœ‹é“¾æ¥ https://huggingface.co/sb3/dqn-BeamRiderNoFrameskip-v4#hyperparameters. è¿™é‡Œ, **åœ¨æ¨¡å‹å¡é‡Œï¼Œä½ ä¼šè·å¾—è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“è¶…å‚æ•°ã€‚**

ä½†æ˜¯æ‰¾åˆ°è¶…å‚æ•°æ˜¯ä¸€ä»¶è‰°å·¨çš„äº‹æƒ…ï¼Œå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å°†ä¼šåœ¨ä¸‹ä¸€ä¸ªå¥–åŠ±å•å…ƒä¸­å±•ç¤º**æ€æ ·ä½¿ç”¨ Optuna ä¼˜åŒ–ä½ çš„è¶…å‚æ•° ğŸ”¥ã€‚**


## ä¸€äº›é¢å¤–çš„æŒ‘æˆ˜ ğŸ†

æœ€ä½³çš„å­¦ä¹ æ–¹å¼å°±æ˜¯**äº²è‡ªå°è¯•**ï¼

åœ¨ [Leaderboard](https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard) ä½ å°†ä¼šæ‰¾åˆ°ä½ çš„æ™ºèƒ½ä½“ã€‚ä½ èƒ½æ‰“æ¦œç™»é¡¶å—ï¼Ÿ

è¿™é‡Œæœ‰ä¸€ä»½ç¯å¢ƒåˆ—è¡¨ä½ å¯ä»¥å°è¯•è®­ç»ƒä½ çš„æ™ºèƒ½ä½“ï¼š
- BeamRiderNoFrameskip-v4
- BreakoutNoFrameskip-v4
- EnduroNoFrameskip-v4
- PongNoFrameskip-v4

åŒæ ·ï¼Œ**å¦‚æœä½ æƒ³è¦å­¦ä¹ è‡ªå·±æ‰§è¡Œæ·±åº¦ Q-Learning**,ä½ ä¸€å®šè¦çœ‹ä¸€çœ‹ CleanRL è¿è¡Œè¿‡ç¨‹ https://github.com/vwxyzjn/cleanrl/blob/master/cleanrl/dqn_atari.py

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit4/atari-envs.gif" alt="Environments"/>

________________________________________________________________________
æ­å–œä½ å®Œæˆæœ¬ç« !

å¦‚æœä½ ä»æ—§å¯¹æŸäº›éƒ¨åˆ†æ„Ÿåˆ°å›°æƒ‘...å®Œå…¨æ­£å¸¸ï¼**è¿™å¯¹äºæ‰€æœ‰å­¦ä¹  RL çš„äººéƒ½ä¸€æ ·**ã€‚

åœ¨ç»§ç»­ä¸‹ä¸€ç« ä¹‹å‰è¯·èŠ±æ—¶é—´**ä»”ç»†å›é¡¾å¹¶å°è¯•é¢å¤–æŒ‘æˆ˜**ã€‚è¿™å¯¹äºç¨³å›ºåŸºç¡€ååˆ†é‡è¦ã€‚

åœ¨ä¸‹ä¸€å•å…ƒï¼Œæˆ‘ä»¬**å°†è¦å­¦ä¹  [Optuna](https://optuna.org/)**. ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ ä¸­æœ€å…³é”®çš„ä»»åŠ¡ï¼Œå¯»æ‰¾æœ€ä¼˜è¶…å‚æ•°ã€‚ Optuna æ˜¯ä¸€ä¸ªå¸®åŠ©ä½ è¿›è¡Œè‡ªåŠ¨æœç´¢çš„åº“

è®©æˆ‘ä»¬åœ¨å¥–åŠ±å•å…ƒ 2 å†è§! ğŸ”¥

### ä¿æŒçƒ­çˆ±ï¼Œå¥”èµ´å±±æµ· ğŸ¤—
