# å®è·µç»ƒä¹  [[hands-on]]



      <CourseFloatingBanner classNames="absolute z-10 right-0 top-0"
      notebooks={[
        {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/deep-rl-class/blob/main/notebooks/unit3/unit3.ipynb"}
        ]}
        askForHelpUrl="http://hf.co/join/discord" />


ç°åœ¨ä½ å·²ç»å­¦ä¹ äº†æ·±åº¦Q-Learningçš„ç†è®ºï¼Œ**ä½ å·²ç»å‡†å¤‡å¥½è®­ç»ƒä½ çš„æ·±åº¦Q-Learningæ™ºèƒ½ä½“æ¥ç©Atariæ¸¸æˆäº†**ã€‚æˆ‘ä»¬å°†ä»å¤ªç©ºå…¥ä¾µè€…å¼€å§‹ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•ä½ æƒ³è¦çš„Atariæ¸¸æˆ ğŸ”¥

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit4/atari-envs.gif" alt="Environments"/>


æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯[RL-Baselines-3 Zooé›†æˆ](https://github.com/DLR-RM/rl-baselines3-zoo)ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸå§‹ç‰ˆæœ¬çš„æ·±åº¦Q-Learningï¼Œæ²¡æœ‰è¯¸å¦‚Double-DQNã€Dueling-DQNæˆ–ä¼˜å…ˆç»éªŒå›æ”¾ç­‰æ‰©å±•ã€‚

å¦å¤–ï¼Œ**å¦‚æœä½ æƒ³åœ¨è¿™ä¸ªå®è·µç»ƒä¹ ä¹‹åå­¦ä¹ è‡ªå·±å®ç°æ·±åº¦Q-Learning**ï¼Œä½ ç»å¯¹åº”è¯¥çœ‹çœ‹CleanRLçš„å®ç°ï¼šhttps://github.com/vwxyzjn/cleanrl/blob/master/cleanrl/dqn_atari.py

ä¸ºäº†åœ¨è®¤è¯è¿‡ç¨‹ä¸­éªŒè¯è¿™ä¸ªå®è·µç»ƒä¹ ï¼Œä½ éœ€è¦å°†ä½ è®­ç»ƒå¥½çš„æ¨¡å‹æ¨é€åˆ°Hubå¹¶**è·å¾— >= 200çš„ç»“æœ**ã€‚

è¦æ‰¾åˆ°ä½ çš„ç»“æœï¼Œè¯·å‰å¾€æ’è¡Œæ¦œå¹¶æ‰¾åˆ°ä½ çš„æ¨¡å‹ï¼Œ**ç»“æœ = å¹³å‡å¥–åŠ± - å¥–åŠ±çš„æ ‡å‡†å·®**

**å¦‚æœä½ æ‰¾ä¸åˆ°ä½ çš„æ¨¡å‹ï¼Œè¯·æ»šåŠ¨åˆ°é¡µé¢åº•éƒ¨å¹¶ç‚¹å‡»åˆ·æ–°æŒ‰é’®ã€‚**

æœ‰å…³è®¤è¯è¿‡ç¨‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤éƒ¨åˆ† ğŸ‘‰ https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process

ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ä½ çš„è¿›åº¦ ğŸ‘‰ https://huggingface.co/spaces/ThomasSimonini/Check-my-progress-Deep-RL-Course


**è¦å¼€å§‹å®è·µç»ƒä¹ ï¼Œè¯·ç‚¹å‡»"åœ¨Colabä¸­æ‰“å¼€"æŒ‰é’®** ğŸ‘‡ï¼š

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/huggingface/deep-rl-class/blob/master/notebooks/unit3/unit3.ipynb)

# ç¬¬3å•å…ƒï¼šä½¿ç”¨RL Baselines3 Zooåœ¨Atariæ¸¸æˆä¸­å®ç°æ·±åº¦Q-Learning ğŸ‘¾

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit4/thumbnail.jpg" alt="Unit 3 Thumbnail" />

åœ¨è¿™ä¸ªå®è·µç»ƒä¹ ä¸­ï¼Œ**ä½ å°†è®­ç»ƒä¸€ä¸ªæ·±åº¦Q-Learningæ™ºèƒ½ä½“**ï¼Œä½¿ç”¨[RL Baselines3 Zoo](https://github.com/DLR-RM/rl-baselines3-zoo)ç©å¤ªç©ºå…¥ä¾µè€…ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäº[Stable-Baselines3](https://stable-baselines3.readthedocs.io/en/master/)çš„è®­ç»ƒæ¡†æ¶ï¼Œæä¾›äº†è®­ç»ƒã€è¯„ä¼°æ™ºèƒ½ä½“ã€è°ƒæ•´è¶…å‚æ•°ã€ç»˜åˆ¶ç»“æœå’Œå½•åˆ¶è§†é¢‘çš„è„šæœ¬ã€‚

æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯[RL-Baselines-3 Zooé›†æˆï¼Œè¿™æ˜¯ä¸€ä¸ªåŸå§‹ç‰ˆæœ¬çš„æ·±åº¦Q-Learning](https://stable-baselines3.readthedocs.io/en/master/modules/dqn.html)ï¼Œæ²¡æœ‰è¯¸å¦‚Double-DQNã€Dueling-DQNå’Œä¼˜å…ˆç»éªŒå›æ”¾ç­‰æ‰©å±•ã€‚

### ğŸ® ç¯å¢ƒï¼š

- [SpacesInvadersNoFrameskip-v4](https://gymnasium.farama.org/environments/atari/space_invaders/)

ä½ å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°å¤ªç©ºå…¥ä¾µè€…ç‰ˆæœ¬ä¹‹é—´çš„åŒºåˆ« ğŸ‘‰ https://gymnasium.farama.org/environments/atari/space_invaders/#variants

### ğŸ“š RLåº“ï¼š

- [RL-Baselines3-Zoo](https://github.com/DLR-RM/rl-baselines3-zoo)

## æœ¬å®è·µç»ƒä¹ çš„ç›®æ ‡ ğŸ†

åœ¨å®Œæˆå®è·µç»ƒä¹ åï¼Œä½ å°†ï¼š
- èƒ½å¤Ÿæ›´æ·±å…¥åœ°**ç†è§£RL Baselines3 Zooçš„å·¥ä½œåŸç†**ã€‚
- èƒ½å¤Ÿ**å°†ä½ è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“å’Œä»£ç æ¨é€åˆ°Hub**ï¼Œé™„å¸¦ç²¾ç¾çš„è§†é¢‘å›æ”¾å’Œè¯„ä¼°åˆ†æ•° ğŸ”¥ã€‚

## å…ˆå†³æ¡ä»¶ ğŸ—ï¸

åœ¨æ·±å…¥å­¦ä¹ å®è·µç»ƒä¹ ä¹‹å‰ï¼Œä½ éœ€è¦ï¼š

ğŸ”² ğŸ“š **[é€šè¿‡é˜…è¯»ç¬¬3å•å…ƒå­¦ä¹ æ·±åº¦Q-Learning](https://huggingface.co/deep-rl-course/unit3/introduction)**  ğŸ¤—

æˆ‘ä»¬ä¸€ç›´åœ¨åŠªåŠ›æ”¹è¿›æˆ‘ä»¬çš„æ•™ç¨‹ï¼Œæ‰€ä»¥**å¦‚æœä½ åœ¨è¿™ä¸ªå®è·µç»ƒä¹ ä¸­å‘ç°ä¸€äº›é—®é¢˜**ï¼Œè¯·[åœ¨GitHubä»“åº“ä¸Šæå‡ºissue](https://github.com/huggingface/deep-rl-class/issues)ã€‚

# è®©æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªç©Atariå¤ªç©ºå…¥ä¾µè€…çš„æ·±åº¦Q-Learningæ™ºèƒ½ä½“ ğŸ‘¾ å¹¶å°†å…¶ä¸Šä¼ åˆ°Hubã€‚

æˆ‘ä»¬å¼ºçƒˆå»ºè®®å­¦ç”Ÿ**ä½¿ç”¨Google Colabè¿›è¡Œå®è·µç»ƒä¹ ï¼Œè€Œä¸æ˜¯åœ¨ä¸ªäººç”µè„‘ä¸Šè¿è¡Œå®ƒä»¬**ã€‚

é€šè¿‡ä½¿ç”¨Google Colabï¼Œ**ä½ å¯ä»¥ä¸“æ³¨äºå­¦ä¹ å’Œå®éªŒï¼Œè€Œä¸å¿…æ‹…å¿ƒè®¾ç½®ç¯å¢ƒçš„æŠ€æœ¯æ–¹é¢**ã€‚

ä¸ºäº†åœ¨è®¤è¯è¿‡ç¨‹ä¸­éªŒè¯è¿™ä¸ªå®è·µç»ƒä¹ ï¼Œä½ éœ€è¦å°†ä½ è®­ç»ƒå¥½çš„æ¨¡å‹æ¨é€åˆ°Hubå¹¶**è·å¾— >= 200çš„ç»“æœ**ã€‚

è¦æ‰¾åˆ°ä½ çš„ç»“æœï¼Œè¯·å‰å¾€æ’è¡Œæ¦œå¹¶æ‰¾åˆ°ä½ çš„æ¨¡å‹ï¼Œ**ç»“æœ = å¹³å‡å¥–åŠ± - å¥–åŠ±çš„æ ‡å‡†å·®**

æœ‰å…³è®¤è¯è¿‡ç¨‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤éƒ¨åˆ† ğŸ‘‰ https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process

## è®¾ç½®GPU ğŸ’ª

- ä¸ºäº†**åŠ é€Ÿæ™ºèƒ½ä½“çš„è®­ç»ƒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨GPU**ã€‚ä¸ºæ­¤ï¼Œè¯·å‰å¾€`Runtime > Change Runtime type`

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/gpu-step1.jpg" alt="GPU Step 1" />

- `Hardware Accelerator > GPU`

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/gpu-step2.jpg" alt="GPU Step 2" />

# å®‰è£…RL-Baselines3 ZooåŠå…¶ä¾èµ–é¡¹ ğŸ“š

å¦‚æœä½ çœ‹åˆ°`ERROR: pip's dependency resolver does not currently take into account all the packages that are installed.` **è¿™æ˜¯æ­£å¸¸çš„ï¼Œä¸æ˜¯ä¸¥é‡é”™è¯¯**ï¼Œåªæ˜¯ç‰ˆæœ¬å†²çªã€‚ä½†æˆ‘ä»¬éœ€è¦çš„åŒ…å·²ç»å®‰è£…ã€‚

```python
# ç°åœ¨æˆ‘ä»¬å®‰è£…RL-Baselines3 Zooçš„è¿™ä¸ªæ›´æ–°
pip install git+https://github.com/DLR-RM/rl-baselines3-zoo
```

```bash
apt-get install swig cmake ffmpeg
```

ä¸ºäº†èƒ½å¤Ÿåœ¨Gymnasiumä¸­ä½¿ç”¨Atariæ¸¸æˆï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…atariåŒ…ã€‚å¹¶ä½¿ç”¨accept-rom-licenseæ¥ä¸‹è½½romæ–‡ä»¶ï¼ˆæ¸¸æˆæ–‡ä»¶ï¼‰ã€‚

```python
!pip install gymnasium[atari]
!pip install gymnasium[accept-rom-license]
```

## åˆ›å»ºè™šæ‹Ÿæ˜¾ç¤ºå™¨ ğŸ”½

åœ¨å®è·µç»ƒä¹ ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆå›æ”¾è§†é¢‘ã€‚ä¸ºæ­¤ï¼Œå¦‚æœä½ åœ¨æ— å¤´æœºå™¨ä¸Šè®­ç»ƒï¼Œ**æˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªè™šæ‹Ÿå±å¹•æ¥èƒ½å¤Ÿæ¸²æŸ“ç¯å¢ƒ**ï¼ˆå¹¶å› æ­¤è®°å½•å¸§ï¼‰ã€‚

å› æ­¤ï¼Œä»¥ä¸‹å•å…ƒå°†å®‰è£…åº“å¹¶åˆ›å»ºå¹¶è¿è¡Œè™šæ‹Ÿå±å¹• ğŸ–¥

```bash
apt install python-opengl
apt install ffmpeg
apt install xvfb
pip3 install pyvirtualdisplay
```

```python
# è™šæ‹Ÿæ˜¾ç¤ºå™¨
from pyvirtualdisplay import Display

virtual_display = Display(visible=0, size=(1400, 900))
virtual_display.start()
```

## è®­ç»ƒæˆ‘ä»¬çš„æ·±åº¦Q-Learningæ™ºèƒ½ä½“æ¥ç©å¤ªç©ºå…¥ä¾µè€… ğŸ‘¾

è¦ä½¿ç”¨RL-Baselines3-Zooè®­ç»ƒæ™ºèƒ½ä½“ï¼Œæˆ‘ä»¬åªéœ€è¦åšä¸¤ä»¶äº‹ï¼š

1. åˆ›å»ºä¸€ä¸ªåŒ…å«æˆ‘ä»¬è®­ç»ƒè¶…å‚æ•°çš„è¶…å‚æ•°é…ç½®æ–‡ä»¶ï¼Œç§°ä¸º`dqn.yml`ã€‚

è¿™æ˜¯ä¸€ä¸ªæ¨¡æ¿ç¤ºä¾‹ï¼š

```
SpaceInvadersNoFrameskip-v4:
  env_wrapper:
    - stable_baselines3.common.atari_wrappers.AtariWrapper
  frame_stack: 4
  policy: 'CnnPolicy'
  n_timesteps: !!float 1e7
  buffer_size: 100000
  learning_rate: !!float 1e-4
  batch_size: 32
  learning_starts: 100000
  target_update_interval: 1000
  train_freq: 4
  gradient_steps: 1
  exploration_fraction: 0.1
  exploration_final_eps: 0.01
  # å¦‚æœä¸ºTrueï¼Œä½ éœ€è¦åœ¨replay_buffer_kwargsä¸­åœç”¨handle_timeout_termination
  optimize_memory_usage: False
```

åœ¨è¿™é‡Œæˆ‘ä»¬çœ‹åˆ°ï¼š
- æˆ‘ä»¬ä½¿ç”¨`Atari Wrapper`ï¼Œå®ƒé¢„å¤„ç†è¾“å…¥ï¼ˆå¸§å‡å°‘ï¼Œç°åº¦ï¼Œå †å 4å¸§ï¼‰
- æˆ‘ä»¬ä½¿ç”¨`CnnPolicy`ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨å·ç§¯å±‚æ¥å¤„ç†å¸§
- æˆ‘ä»¬è®­ç»ƒå®ƒ1000ä¸‡ä¸ª`n_timesteps`
- å†…å­˜ï¼ˆç»éªŒå›æ”¾ï¼‰å¤§å°ä¸º100000ï¼Œå³ä½ ä¿å­˜ç”¨æ¥å†æ¬¡è®­ç»ƒä½ çš„æ™ºèƒ½ä½“çš„ç»éªŒæ­¥éª¤æ•°é‡ã€‚

ğŸ’¡ æˆ‘çš„å»ºè®®æ˜¯**å°†è®­ç»ƒæ—¶é—´æ­¥æ•°å‡å°‘åˆ°1M**ï¼Œè¿™åœ¨P100ä¸Šå¤§çº¦éœ€è¦90åˆ†é’Ÿã€‚`!nvidia-smi`å°†å‘Šè¯‰ä½ ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆGPUã€‚åœ¨1000ä¸‡æ­¥æ—¶ï¼Œè¿™å°†éœ€è¦å¤§çº¦9å°æ—¶ã€‚æˆ‘å»ºè®®åœ¨ä½ çš„æœ¬åœ°è®¡ç®—æœºï¼ˆæˆ–å…¶ä»–åœ°æ–¹ï¼‰ä¸Šè¿è¡Œã€‚åªéœ€ç‚¹å‡»ï¼š`File>Download`ã€‚

åœ¨è¶…å‚æ•°ä¼˜åŒ–æ–¹é¢ï¼Œæˆ‘çš„å»ºè®®æ˜¯ä¸“æ³¨äºè¿™3ä¸ªè¶…å‚æ•°ï¼š
- `learning_rate`
- `buffer_sizeï¼ˆç»éªŒå†…å­˜å¤§å°ï¼‰`
- `batch_size`

ä½œä¸ºä¸€ä¸ªå¥½ä¹ æƒ¯ï¼Œä½ éœ€è¦**æŸ¥çœ‹æ–‡æ¡£ä»¥äº†è§£æ¯ä¸ªè¶…å‚æ•°çš„ä½œç”¨**ï¼šhttps://stable-baselines3.readthedocs.io/en/master/modules/dqn.html#parameters



2. æˆ‘ä»¬å¼€å§‹è®­ç»ƒå¹¶å°†æ¨¡å‹ä¿å­˜åœ¨`logs`æ–‡ä»¶å¤¹ä¸­ ğŸ“

- åœ¨`--algo`åå®šä¹‰ç®—æ³•ï¼Œåœ¨`-f`åå®šä¹‰ä¿å­˜æ¨¡å‹çš„ä½ç½®ï¼Œåœ¨`-c`åå®šä¹‰è¶…å‚æ•°é…ç½®çš„ä½ç½®ã€‚

```bash
python -m rl_zoo3.train --algo ________ --env SpaceInvadersNoFrameskip-v4  -f _________  -c _________
```

#### è§£å†³æ–¹æ¡ˆ

```bash
python -m rl_zoo3.train --algo dqn  --env SpaceInvadersNoFrameskip-v4 -f logs/ -c dqn.yml
```

## è®©æˆ‘ä»¬è¯„ä¼°æˆ‘ä»¬çš„æ™ºèƒ½ä½“ ğŸ‘€

- RL-Baselines3-Zooæä¾›äº†`enjoy.py`ï¼Œä¸€ä¸ªç”¨äºè¯„ä¼°æˆ‘ä»¬çš„æ™ºèƒ½ä½“çš„Pythonè„šæœ¬ã€‚åœ¨å¤§å¤šæ•°RLåº“ä¸­ï¼Œæˆ‘ä»¬ç§°è¯„ä¼°è„šæœ¬ä¸º`enjoy.py`ã€‚
- è®©æˆ‘ä»¬è¯„ä¼°å®ƒ5000ä¸ªæ—¶é—´æ­¥ ğŸ”¥

```bash
python -m rl_zoo3.enjoy  --algo dqn  --env SpaceInvadersNoFrameskip-v4  --no-render  --n-timesteps _________  --folder logs/
```

#### è§£å†³æ–¹æ¡ˆ

```bash
python -m rl_zoo3.enjoy  --algo dqn  --env SpaceInvadersNoFrameskip-v4  --no-render  --n-timesteps 5000  --folder logs/
```

## åœ¨Hubä¸Šå‘å¸ƒæˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹ ğŸš€
ç°åœ¨æˆ‘ä»¬çœ‹åˆ°è®­ç»ƒåè·å¾—äº†è‰¯å¥½çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€è¡Œä»£ç å°†æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹å‘å¸ƒåˆ°hub ğŸ¤—ã€‚

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/unit3/space-invaders-model.gif" alt="Space Invaders model" />

é€šè¿‡ä½¿ç”¨`rl_zoo3.push_to_hub`ï¼Œ**ä½ å¯ä»¥è¯„ä¼°ã€è®°å½•å›æ”¾ã€ç”Ÿæˆæ™ºèƒ½ä½“çš„æ¨¡å‹å¡ç‰‡å¹¶å°†å…¶æ¨é€åˆ°hub**ã€‚

è¿™æ ·ï¼š
- ä½ å¯ä»¥**å±•ç¤ºæˆ‘ä»¬çš„å·¥ä½œ** ğŸ”¥
- ä½ å¯ä»¥**å¯è§†åŒ–ä½ çš„æ™ºèƒ½ä½“çš„æ¸¸æˆè¿‡ç¨‹** ğŸ‘€
- ä½ å¯ä»¥**ä¸ç¤¾åŒºåˆ†äº«ä¸€ä¸ªå…¶ä»–äººå¯ä»¥ä½¿ç”¨çš„æ™ºèƒ½ä½“** ğŸ’¾
- ä½ å¯ä»¥**è®¿é—®æ’è¡Œæ¦œ ğŸ† æ¥çœ‹çœ‹ä½ çš„æ™ºèƒ½ä½“ä¸åŒå­¦ç›¸æ¯”è¡¨ç°å¦‚ä½•** ğŸ‘‰  https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard

è¦èƒ½å¤Ÿä¸ç¤¾åŒºåˆ†äº«ä½ çš„æ¨¡å‹ï¼Œè¿˜æœ‰ä¸‰ä¸ªæ­¥éª¤éœ€è¦éµå¾ªï¼š

1ï¸âƒ£ ï¼ˆå¦‚æœè¿˜æ²¡æœ‰å®Œæˆï¼‰åœ¨HFåˆ›å»ºä¸€ä¸ªè´¦æˆ· â¡ https://huggingface.co/join

2ï¸âƒ£ ç™»å½•ï¼Œç„¶åï¼Œä½ éœ€è¦ä»Hugging Faceç½‘ç«™å­˜å‚¨ä½ çš„è®¤è¯ä»¤ç‰Œã€‚
- åˆ›å»ºä¸€ä¸ªæ–°ä»¤ç‰Œï¼ˆhttps://huggingface.co/settings/tokensï¼‰**å…·æœ‰å†™å…¥è§’è‰²**

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/create-token.jpg" alt="Create HF Token" />

- å¤åˆ¶ä»¤ç‰Œ
- è¿è¡Œä¸‹é¢çš„å•å…ƒå¹¶ç²˜è´´ä»¤ç‰Œ

```bash
from huggingface_hub import notebook_login # ç™»å½•æˆ‘ä»¬çš„Hugging Faceè´¦æˆ·ï¼Œä»¥ä¾¿èƒ½å¤Ÿä¸Šä¼ æ¨¡å‹åˆ°Hubã€‚
notebook_login()
!git config --global credential.helper store
```

å¦‚æœä½ ä¸æƒ³ä½¿ç”¨Google Colabæˆ–Jupyter Notebookï¼Œä½ éœ€è¦ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼š`huggingface-cli login`

3ï¸âƒ£ æˆ‘ä»¬ç°åœ¨å‡†å¤‡å¥½å°†æˆ‘ä»¬è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“æ¨é€åˆ°ğŸ¤— Hub ğŸ”¥

è®©æˆ‘ä»¬è¿è¡Œpush_to_hub.pyæ–‡ä»¶ï¼Œå°†æˆ‘ä»¬è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“ä¸Šä¼ åˆ°Hubã€‚

`--repo-name `ï¼šä»“åº“çš„åç§°

`-orga`ï¼šä½ çš„Hugging Faceç”¨æˆ·å

`-f`ï¼šè®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶å¤¹çš„ä½ç½®ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯`logs`ï¼‰

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/unit3/select-id.png" alt="Select Id" />

```bash
python -m rl_zoo3.push_to_hub  --algo dqn  --env SpaceInvadersNoFrameskip-v4  --repo-name _____________________ -orga _____________________ -f logs/
```

#### è§£å†³æ–¹æ¡ˆ

```bash
python -m rl_zoo3.push_to_hub  --algo dqn  --env SpaceInvadersNoFrameskip-v4  --repo-name dqn-SpaceInvadersNoFrameskip-v4  -orga ThomasSimonini  -f logs/
```

###.

æ­å–œ ğŸ¥³ ä½ åˆšåˆšè®­ç»ƒå¹¶ä¸Šä¼ äº†ä½ çš„ç¬¬ä¸€ä¸ªä½¿ç”¨RL-Baselines-3 Zooçš„æ·±åº¦Q-Learningæ™ºèƒ½ä½“ã€‚ä¸Šé¢çš„è„šæœ¬åº”è¯¥å·²ç»æ˜¾ç¤ºäº†ä¸€ä¸ªæ¨¡å‹ä»“åº“çš„é“¾æ¥ï¼Œå¦‚https://huggingface.co/ThomasSimonini/dqn-SpaceInvadersNoFrameskip-v4ã€‚å½“ä½ è®¿é—®è¿™ä¸ªé“¾æ¥æ—¶ï¼Œä½ å¯ä»¥ï¼š

- åœ¨å³ä¾§çœ‹åˆ°**ä½ çš„æ™ºèƒ½ä½“çš„è§†é¢‘é¢„è§ˆ**ã€‚
- ç‚¹å‡»"Files and versions"æŸ¥çœ‹ä»“åº“ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚
- ç‚¹å‡»"Use in stable-baselines3"è·å–æ˜¾ç¤ºå¦‚ä½•åŠ è½½æ¨¡å‹çš„ä»£ç ç‰‡æ®µã€‚
- ä¸€ä¸ªæ¨¡å‹å¡ç‰‡ï¼ˆ`README.md`æ–‡ä»¶ï¼‰ï¼Œå®ƒç»™å‡ºäº†æ¨¡å‹çš„æè¿°å’Œä½ ä½¿ç”¨çš„è¶…å‚æ•°ã€‚

åœ¨åº•å±‚ï¼ŒHubä½¿ç”¨åŸºäºgitçš„ä»“åº“ï¼ˆå¦‚æœä½ ä¸çŸ¥é“gitæ˜¯ä»€ä¹ˆï¼Œä¸ç”¨æ‹…å¿ƒï¼‰ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥éšç€å®éªŒå’Œæ”¹è¿›ä½ çš„æ™ºèƒ½ä½“ï¼Œç”¨æ–°ç‰ˆæœ¬æ›´æ–°æ¨¡å‹ã€‚

**ä½¿ç”¨[æ’è¡Œæ¦œ](https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard)æ¯”è¾ƒä½ çš„æ™ºèƒ½ä½“ä¸åŒå­¦çš„ç»“æœ** ğŸ†

## åŠ è½½ä¸€ä¸ªå¼ºå¤§çš„è®­ç»ƒæ¨¡å‹ ğŸ”¥

- Stable-Baselines3å›¢é˜Ÿåœ¨Hubä¸Šä¸Šä¼ äº†**è¶…è¿‡150ä¸ªè®­ç»ƒå¥½çš„æ·±åº¦å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“**ã€‚

ä½ å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°å®ƒä»¬ï¼šğŸ‘‰ https://huggingface.co/sb3

ä¸€äº›ä¾‹å­ï¼š
- å°è¡Œæ˜Ÿï¼šhttps://huggingface.co/sb3/dqn-AsteroidsNoFrameskip-v4
- å…‰æŸéª‘å£«ï¼šhttps://huggingface.co/sb3/dqn-BeamRiderNoFrameskip-v4
- æ‰“ç –å—ï¼šhttps://huggingface.co/sb3/dqn-BreakoutNoFrameskip-v4
- å…¬è·¯èµ›è½¦ï¼šhttps://huggingface.co/sb3/dqn-RoadRunnerNoFrameskip-v4

è®©æˆ‘ä»¬åŠ è½½ä¸€ä¸ªç©å…‰æŸéª‘å£«çš„æ™ºèƒ½ä½“ï¼šhttps://huggingface.co/sb3/dqn-BeamRiderNoFrameskip-v4

1. æˆ‘ä»¬ä½¿ç”¨`rl_zoo3.load_from_hub`ä¸‹è½½æ¨¡å‹ï¼Œå¹¶å°†å…¶æ”¾åœ¨ä¸€ä¸ªæ–°æ–‡ä»¶å¤¹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸º`rl_trained`

```bash
# ä¸‹è½½æ¨¡å‹å¹¶å°†å…¶ä¿å­˜åˆ°logs/æ–‡ä»¶å¤¹ä¸­
python -m rl_zoo3.load_from_hub --algo dqn --env BeamRiderNoFrameskip-v4 -orga sb3 -f rl_trained/
```

2. è®©æˆ‘ä»¬è¯„ä¼°å®ƒ5000ä¸ªæ—¶é—´æ­¥

```bash
python -m rl_zoo3.enjoy --algo dqn --env BeamRiderNoFrameskip-v4 -n 5000  -f rl_trained/ --no-render
```

ä¸ºä»€ä¹ˆä¸å°è¯•è®­ç»ƒä½ è‡ªå·±çš„**ç©BeamRiderNoFrameskip-v4çš„æ·±åº¦Q-Learningæ™ºèƒ½ä½“ï¼ŸğŸ†**

å¦‚æœä½ æƒ³å°è¯•ï¼Œè¯·æŸ¥çœ‹https://huggingface.co/sb3/dqn-BeamRiderNoFrameskip-v4#hyperparameters **åœ¨æ¨¡å‹å¡ç‰‡ä¸­ï¼Œä½ æœ‰è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“çš„è¶…å‚æ•°ã€‚**

ä½†æ˜¯æ‰¾åˆ°è¶…å‚æ•°å¯èƒ½æ˜¯ä¸€é¡¹è‰°å·¨çš„ä»»åŠ¡ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹ä¸€ä¸ªå•å…ƒä¸­çœ‹åˆ°ï¼Œ**å¦‚ä½•ä½¿ç”¨Optunaæ¥ä¼˜åŒ–è¶…å‚æ•° ğŸ”¥ã€‚**


## ä¸€äº›é¢å¤–çš„æŒ‘æˆ˜ ğŸ†

å­¦ä¹ çš„æœ€å¥½æ–¹æ³•**æ˜¯è‡ªå·±å°è¯•ï¼**

åœ¨[æ’è¡Œæ¦œ](https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard)ä¸­ï¼Œä½ ä¼šæ‰¾åˆ°ä½ çš„æ™ºèƒ½ä½“ã€‚ä½ èƒ½ç™»ä¸Šæ¦œé¦–å—ï¼Ÿ

è¿™é‡Œæœ‰ä¸€ä¸ªä½ å¯ä»¥å°è¯•è®­ç»ƒä½ çš„æ™ºèƒ½ä½“çš„ç¯å¢ƒåˆ—è¡¨ï¼š
- BeamRiderNoFrameskip-v4
- BreakoutNoFrameskip-v4
- EnduroNoFrameskip-v4
- PongNoFrameskip-v4

å¦å¤–ï¼Œ**å¦‚æœä½ æƒ³å­¦ä¹ è‡ªå·±å®ç°æ·±åº¦Q-Learning**ï¼Œä½ ç»å¯¹åº”è¯¥çœ‹çœ‹CleanRLçš„å®ç°ï¼šhttps://github.com/vwxyzjn/cleanrl/blob/master/cleanrl/dqn_atari.py

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit4/atari-envs.gif" alt="Environments"/>

________________________________________________________________________
æ­å–œä½ å®Œæˆæœ¬ç« ï¼

å¦‚æœä½ ä»ç„¶å¯¹æ‰€æœ‰è¿™äº›å…ƒç´ æ„Ÿåˆ°å›°æƒ‘...è¿™æ˜¯å®Œå…¨æ­£å¸¸çš„ï¼**è¿™å¯¹æˆ‘å’Œæ‰€æœ‰å­¦ä¹ RLçš„äººæ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„ã€‚**

åœ¨ç»§ç»­ä¹‹å‰ï¼ŒèŠ±æ—¶é—´çœŸæ­£**æŒæ¡ææ–™å¹¶å°è¯•é¢å¤–çš„æŒ‘æˆ˜**ã€‚æŒæ¡è¿™äº›å…ƒç´ å¹¶å»ºç«‹åšå®çš„åŸºç¡€æ˜¯å¾ˆé‡è¦çš„ã€‚

åœ¨ä¸‹ä¸€ä¸ªå•å…ƒä¸­ï¼Œ**æˆ‘ä»¬å°†å­¦ä¹ [Optuna](https://optuna.org/)**ã€‚æ·±åº¦å¼ºåŒ–å­¦ä¹ ä¸­æœ€å…³é”®çš„ä»»åŠ¡ä¹‹ä¸€æ˜¯æ‰¾åˆ°ä¸€ç»„å¥½çš„è®­ç»ƒè¶…å‚æ•°ã€‚è€ŒOptunaæ˜¯ä¸€ä¸ªå¸®åŠ©ä½ è‡ªåŠ¨åŒ–æœç´¢çš„åº“ã€‚


### è¿™æ˜¯ä¸ä½ ä¸€èµ·æ„å»ºçš„è¯¾ç¨‹ ğŸ‘·ğŸ¿â€â™€ï¸

æœ€åï¼Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡ä½ çš„åé¦ˆè¿­ä»£åœ°æ”¹è¿›å’Œæ›´æ–°è¯¾ç¨‹ã€‚å¦‚æœä½ æœ‰åé¦ˆï¼Œè¯·å¡«å†™è¿™ä¸ªè¡¨æ ¼ ğŸ‘‰ https://forms.gle/3HgA7bEHwAmmLfwh9

æˆ‘ä»¬ä¸€ç›´åœ¨åŠªåŠ›æ”¹è¿›æˆ‘ä»¬çš„æ•™ç¨‹ï¼Œæ‰€ä»¥**å¦‚æœä½ åœ¨è¿™ä¸ªç¬”è®°æœ¬ä¸­å‘ç°ä¸€äº›é—®é¢˜**ï¼Œè¯·[åœ¨GitHubä»“åº“ä¸Šæå‡ºissue](https://github.com/huggingface/deep-rl-class/issues)ã€‚

æˆ‘ä»¬åœ¨å¥–åŠ±å•å…ƒ2è§ï¼ğŸ”¥

### æŒç»­å­¦ä¹ ï¼Œä¿æŒç²¾å½© ğŸ¤—
