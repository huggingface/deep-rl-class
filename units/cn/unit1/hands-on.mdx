# è®­ç»ƒä½ çš„ç¬¬ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“ ğŸ¤– [[hands-on]]




      <CourseFloatingBanner classNames="absolute z-10 right-0 top-0"
      notebooks={[
        {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/deep-rl-class/blob/main/notebooks/unit1/unit1.ipynb"}
        ]}
        askForHelpUrl="http://hf.co/join/discord" />

ç°åœ¨ä½ å·²ç»å­¦ä¹ äº†å¼ºåŒ–å­¦ä¹ çš„åŸºç¡€çŸ¥è¯†ï¼Œä½ å·²ç»å‡†å¤‡å¥½è®­ç»ƒä½ çš„ç¬¬ä¸€ä¸ªæ™ºèƒ½ä½“å¹¶é€šè¿‡Hubä¸ç¤¾åŒºåˆ†äº«å®ƒäº†ğŸ”¥ï¼š
ä¸€ä¸ªæœˆçƒç€é™†å™¨æ™ºèƒ½ä½“ï¼Œå®ƒå°†å­¦ä¹ å¦‚ä½•æ­£ç¡®åœ°åœ¨æœˆçƒä¸Šç€é™† ğŸŒ•

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/lunarLander.gif" alt="LunarLander" />

æœ€åï¼Œä½ å°†**æŠŠè¿™ä¸ªè®­ç»ƒå¥½çš„æ™ºèƒ½ä½“ä¸Šä¼ åˆ°Hugging Face Hub ğŸ¤—ï¼Œè¿™æ˜¯ä¸€ä¸ªå…è´¹ã€å¼€æ”¾çš„å¹³å°ï¼Œäººä»¬å¯ä»¥åœ¨è¿™é‡Œåˆ†äº«MLæ¨¡å‹ã€æ•°æ®é›†å’Œæ¼”ç¤ºã€‚**

æ„Ÿè°¢æˆ‘ä»¬çš„<a href="https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard">æ’è¡Œæ¦œ</a>ï¼Œä½ å°†èƒ½å¤Ÿæ¯”è¾ƒä½ çš„ç»“æœä¸å…¶ä»–åŒå­¦çš„ç»“æœï¼Œå¹¶äº¤æµæœ€ä½³å®è·µæ¥æé«˜ä½ çš„æ™ºèƒ½ä½“çš„åˆ†æ•°ã€‚è°å°†èµ¢å¾—ç¬¬1å•å…ƒçš„æŒ‘æˆ˜ğŸ†ï¼Ÿ

ä¸ºäº†éªŒè¯è¿™ä¸ªå®è·µç¯èŠ‚çš„[è®¤è¯è¿‡ç¨‹](https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process)ï¼Œä½ éœ€è¦å°†ä½ è®­ç»ƒå¥½çš„æ¨¡å‹æ¨é€åˆ°Hubå¹¶**è·å¾— >= 200çš„ç»“æœ**ã€‚

è¦æ‰¾åˆ°ä½ çš„ç»“æœï¼Œè¯·å‰å¾€[æ’è¡Œæ¦œ](https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard)å¹¶æ‰¾åˆ°ä½ çš„æ¨¡å‹ï¼Œ**ç»“æœ = å¹³å‡å¥–åŠ± - å¥–åŠ±çš„æ ‡å‡†å·®**

**å¦‚æœä½ æ‰¾ä¸åˆ°ä½ çš„æ¨¡å‹ï¼Œè¯·å‰å¾€é¡µé¢åº•éƒ¨å¹¶ç‚¹å‡»åˆ·æ–°æŒ‰é’®ã€‚**

æœ‰å…³è®¤è¯è¿‡ç¨‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤éƒ¨åˆ† ğŸ‘‰ https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process

ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹ä½ çš„è¿›åº¦ ğŸ‘‰ https://huggingface.co/spaces/ThomasSimonini/Check-my-progress-Deep-RL-Course

è®©æˆ‘ä»¬å¼€å§‹å§ï¼ğŸš€

**è¦å¼€å§‹å®è·µï¼Œè¯·ç‚¹å‡»Open In ColabæŒ‰é’®** ğŸ‘‡ :

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/huggingface/deep-rl-class/blob/master/notebooks/unit1/unit1.ipynb)

æˆ‘ä»¬å¼ºçƒˆ**å»ºè®®å­¦ç”Ÿä½¿ç”¨Google Colabè¿›è¡Œå®è·µç»ƒä¹ **ï¼Œè€Œä¸æ˜¯åœ¨ä¸ªäººç”µè„‘ä¸Šè¿è¡Œå®ƒä»¬ã€‚

é€šè¿‡ä½¿ç”¨Google Colabï¼Œ**ä½ å¯ä»¥ä¸“æ³¨äºå­¦ä¹ å’Œå®éªŒï¼Œè€Œä¸å¿…æ‹…å¿ƒè®¾ç½®ç¯å¢ƒçš„æŠ€æœ¯æ–¹é¢**ã€‚

# ç¬¬1å•å…ƒï¼šè®­ç»ƒä½ çš„ç¬¬ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“ ğŸ¤–

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/thumbnail.jpg" alt="Unit 1 thumbnail" width="100%" />

åœ¨è¿™ä¸ªç¬”è®°æœ¬ä¸­ï¼Œä½ å°†è®­ç»ƒä½ çš„**ç¬¬ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“**ï¼Œä¸€ä¸ªæœˆçƒç€é™†å™¨æ™ºèƒ½ä½“ï¼Œå®ƒå°†å­¦ä¹ å¦‚ä½•**æ­£ç¡®åœ°åœ¨æœˆçƒä¸Šç€é™† ğŸŒ•**ã€‚ä½¿ç”¨[Stable-Baselines3](https://stable-baselines3.readthedocs.io/en/master/)ï¼Œä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ åº“ï¼Œä¸ç¤¾åŒºåˆ†äº«å®ƒä»¬ï¼Œå¹¶å°è¯•ä¸åŒçš„é…ç½®


### ç¯å¢ƒ ğŸ®

- [LunarLander-v2](https://gymnasium.farama.org/environments/box2d/lunar_lander/)

### ä½¿ç”¨çš„åº“ ğŸ“š

- [Stable-Baselines3](https://stable-baselines3.readthedocs.io/en/master/)

æˆ‘ä»¬ä¸€ç›´åœ¨åŠªåŠ›æ”¹è¿›æˆ‘ä»¬çš„æ•™ç¨‹ï¼Œæ‰€ä»¥**å¦‚æœä½ åœ¨è¿™ä¸ªç¬”è®°æœ¬ä¸­å‘ç°ä¸€äº›é—®é¢˜**ï¼Œè¯·[åœ¨Githubä»“åº“ä¸Šæå‡ºä¸€ä¸ªissue](https://github.com/huggingface/deep-rl-class/issues)ã€‚

## æœ¬ç¬”è®°æœ¬çš„ç›®æ ‡ ğŸ†

åœ¨ç¬”è®°æœ¬ç»“æŸæ—¶ï¼Œä½ å°†ï¼š

- èƒ½å¤Ÿä½¿ç”¨**Gymnasium**ï¼Œç¯å¢ƒåº“ã€‚
- èƒ½å¤Ÿä½¿ç”¨**Stable-Baselines3**ï¼Œæ·±åº¦å¼ºåŒ–å­¦ä¹ åº“ã€‚
- èƒ½å¤Ÿ**å°†ä½ è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“æ¨é€åˆ°Hub**ï¼Œå¹¶é™„å¸¦ä¸€ä¸ªæ¼‚äº®çš„è§†é¢‘å›æ”¾å’Œè¯„ä¼°åˆ†æ•° ğŸ”¥ã€‚


## æœ¬ç¬”è®°æœ¬æ¥è‡ªæ·±åº¦å¼ºåŒ–å­¦ä¹ è¯¾ç¨‹

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/deep-rl-course-illustration.jpg" alt="Deep RL Course illustration"/>

åœ¨è¿™ä¸ªå…è´¹è¯¾ç¨‹ä¸­ï¼Œä½ å°†ï¼š

- ğŸ“– åœ¨**ç†è®ºå’Œå®è·µ**ä¸­å­¦ä¹ æ·±åº¦å¼ºåŒ–å­¦ä¹ ã€‚
- ğŸ§‘â€ğŸ’» å­¦ä¹ **ä½¿ç”¨è‘—åçš„æ·±åº¦å¼ºåŒ–å­¦ä¹ åº“**ï¼Œå¦‚Stable Baselines3ã€RL Baselines3 Zooã€CleanRLå’ŒSample Factory 2.0ã€‚
- ğŸ¤– åœ¨**ç‹¬ç‰¹çš„ç¯å¢ƒä¸­è®­ç»ƒæ™ºèƒ½ä½“**
- ğŸ“ é€šè¿‡å®Œæˆ80%çš„ä½œä¸š**è·å¾—å®Œæˆè¯ä¹¦**ã€‚

è¿˜æœ‰æ›´å¤šï¼

æŸ¥çœ‹ ğŸ“š è¯¾ç¨‹å¤§çº² ğŸ‘‰ https://simoninithomas.github.io/deep-rl-course

ä¸è¦å¿˜è®°**<a href="http://eepurl.com/ic5ZUD">æ³¨å†Œè¯¾ç¨‹</a>**ï¼ˆæˆ‘ä»¬æ”¶é›†ä½ çš„ç”µå­é‚®ä»¶æ˜¯ä¸ºäº†èƒ½å¤Ÿ**åœ¨æ¯ä¸ªå•å…ƒå‘å¸ƒæ—¶å‘ä½ å‘é€é“¾æ¥ï¼Œå¹¶æä¾›æœ‰å…³æŒ‘æˆ˜å’Œæ›´æ–°çš„ä¿¡æ¯**ã€‚ï¼‰

ä¸æˆ‘ä»¬ä¿æŒè”ç³»å’Œæé—®çš„æœ€ä½³æ–¹å¼æ˜¯**åŠ å…¥æˆ‘ä»¬çš„discordæœåŠ¡å™¨**ï¼Œä¸ç¤¾åŒºå’Œæˆ‘ä»¬äº¤æµ ğŸ‘‰ğŸ» https://discord.gg/ydHrjt3WP5

## å…ˆå†³æ¡ä»¶ ğŸ—ï¸

åœ¨æ·±å…¥ç¬”è®°æœ¬ä¹‹å‰ï¼Œä½ éœ€è¦ï¼š

ğŸ”² ğŸ“ **[é˜…è¯»ç¬¬0å•å…ƒ](https://huggingface.co/deep-rl-course/unit0/introduction)**ï¼Œå®ƒä¸ºä½ æä¾›äº†å…³äºè¯¾ç¨‹çš„æ‰€æœ‰**ä¿¡æ¯ï¼Œå¹¶å¸®åŠ©ä½ å…¥é—¨** ğŸ¤—

ğŸ”² ğŸ“š **é€šè¿‡[é˜…è¯»ç¬¬1å•å…ƒ](https://huggingface.co/deep-rl-course/unit1/introduction)æ¥äº†è§£å¼ºåŒ–å­¦ä¹ çš„åŸºç¡€çŸ¥è¯†**ï¼ˆMCã€TDã€å¥–åŠ±å‡è®¾...ï¼‰ã€‚

## æ·±åº¦å¼ºåŒ–å­¦ä¹ çš„ç®€è¦å›é¡¾ ğŸ“š

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/RL_process_game.jpg" alt="The RL process" width="100%" />

è®©æˆ‘ä»¬å¯¹ç¬¬ä¸€å•å…ƒä¸­å­¦åˆ°çš„å†…å®¹åšä¸€ä¸ªç®€è¦å›é¡¾ï¼š

- å¼ºåŒ–å­¦ä¹ æ˜¯ä¸€ç§**ä»è¡ŒåŠ¨ä¸­å­¦ä¹ çš„è®¡ç®—æ–¹æ³•**ã€‚æˆ‘ä»¬æ„å»ºä¸€ä¸ªæ™ºèƒ½ä½“ï¼Œé€šè¿‡**ä¸ç¯å¢ƒè¿›è¡Œè¯•é”™äº¤äº’**å¹¶æ¥æ”¶å¥–åŠ±ï¼ˆè´Ÿé¢æˆ–æ­£é¢ï¼‰ä½œä¸ºåé¦ˆæ¥ä»ç¯å¢ƒä¸­å­¦ä¹ ã€‚

- ä»»ä½•å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“çš„ç›®æ ‡éƒ½æ˜¯**æœ€å¤§åŒ–å…¶é¢„æœŸç´¯ç§¯å¥–åŠ±**ï¼ˆä¹Ÿç§°ä¸ºé¢„æœŸå›æŠ¥ï¼‰ï¼Œå› ä¸ºå¼ºåŒ–å­¦ä¹ åŸºäº*å¥–åŠ±å‡è®¾*ï¼Œå³æ‰€æœ‰ç›®æ ‡éƒ½å¯ä»¥æè¿°ä¸ºé¢„æœŸç´¯ç§¯å¥–åŠ±çš„æœ€å¤§åŒ–ã€‚

- å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹æ˜¯ä¸€ä¸ª**å¾ªç¯ï¼Œè¾“å‡ºçŠ¶æ€ã€åŠ¨ä½œã€å¥–åŠ±å’Œä¸‹ä¸€ä¸ªçŠ¶æ€çš„åºåˆ—**ã€‚

- ä¸ºäº†è®¡ç®—é¢„æœŸç´¯ç§¯å¥–åŠ±ï¼ˆé¢„æœŸå›æŠ¥ï¼‰ï¼Œ**æˆ‘ä»¬å¯¹å¥–åŠ±è¿›è¡ŒæŠ˜æ‰£**ï¼šè¾ƒæ—©ï¼ˆåœ¨æ¸¸æˆå¼€å§‹æ—¶ï¼‰è·å¾—çš„å¥–åŠ±æ›´æœ‰å¯èƒ½å‘ç”Ÿï¼Œå› ä¸ºå®ƒä»¬æ¯”é•¿æœŸæœªæ¥å¥–åŠ±æ›´å¯é¢„æµ‹ã€‚

- ä¸ºäº†è§£å†³RLé—®é¢˜ï¼Œä½ éœ€è¦æ‰¾åˆ°ä¸€ä¸ª**æœ€ä¼˜ç­–ç•¥**ï¼›ç­–ç•¥æ˜¯ä½ çš„AIçš„"å¤§è„‘"ï¼Œå®ƒä¼šå‘Šè¯‰ä½ ç»™å®šçŠ¶æ€æ—¶è¦é‡‡å–çš„åŠ¨ä½œã€‚æœ€ä¼˜ç­–ç•¥æ˜¯æœ€å¤§åŒ–é¢„æœŸå›æŠ¥çš„ç­–ç•¥ã€‚

æœ‰ä¸¤ç§æ‰¾åˆ°æœ€ä¼˜ç­–ç•¥çš„æ–¹æ³•ï¼š

- é€šè¿‡**ç›´æ¥è®­ç»ƒç­–ç•¥**ï¼šç­–ç•¥å­¦ä¹ æ–¹æ³•ã€‚
- é€šè¿‡**è®­ç»ƒä»·å€¼å‡½æ•°**æ¥å‘Šè¯‰æˆ‘ä»¬æ¯ä¸ªçŠ¶æ€çš„é¢„æœŸå›æŠ¥ï¼Œå¹¶ä½¿ç”¨è¿™ä¸ªå‡½æ•°æ¥å®šä¹‰æˆ‘ä»¬çš„ç­–ç•¥ï¼šä»·å€¼å­¦ä¹ æ–¹æ³•ã€‚

- æœ€åï¼Œæˆ‘ä»¬è°ˆåˆ°äº†æ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼Œå› ä¸º**æˆ‘ä»¬å¼•å…¥äº†æ·±åº¦ç¥ç»ç½‘ç»œæ¥ä¼°è®¡è¦é‡‡å–çš„åŠ¨ä½œï¼ˆç­–ç•¥å­¦ä¹ ï¼‰æˆ–ä¼°è®¡çŠ¶æ€çš„ä»·å€¼ï¼ˆä»·å€¼å­¦ä¹ ï¼‰ï¼Œå› æ­¤å¾—å"æ·±åº¦"ã€‚**

# è®©æˆ‘ä»¬è®­ç»ƒæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“å¹¶å°†å…¶ä¸Šä¼ åˆ°Hub ğŸš€

## è·å–è¯ä¹¦ ğŸ“

ä¸ºäº†éªŒè¯è¿™ä¸ªå®è·µç¯èŠ‚çš„[è®¤è¯è¿‡ç¨‹](https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process)ï¼Œä½ éœ€è¦å°†ä½ è®­ç»ƒå¥½çš„æ¨¡å‹æ¨é€åˆ°Hubå¹¶**è·å¾— >= 200çš„ç»“æœ**ã€‚

è¦æ‰¾åˆ°ä½ çš„ç»“æœï¼Œè¯·å‰å¾€[æ’è¡Œæ¦œ](https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard)å¹¶æ‰¾åˆ°ä½ çš„æ¨¡å‹ï¼Œ**ç»“æœ = å¹³å‡å¥–åŠ± - å¥–åŠ±çš„æ ‡å‡†å·®**

æœ‰å…³è®¤è¯è¿‡ç¨‹çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹æ­¤éƒ¨åˆ† ğŸ‘‰ https://huggingface.co/deep-rl-course/en/unit0/introduction#certification-process

## è®¾ç½®GPU ğŸ’ª

- ä¸ºäº†**åŠ é€Ÿæ™ºèƒ½ä½“çš„è®­ç»ƒï¼Œæˆ‘ä»¬å°†ä½¿ç”¨GPU**ã€‚ä¸ºæ­¤ï¼Œè¯·è½¬åˆ°`Runtime > Change Runtime type`

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/gpu-step1.jpg" alt="GPU Step 1" />

- `Hardware Accelerator > GPU`

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/gpu-step2.jpg" alt="GPU Step 2" />

## å®‰è£…ä¾èµ–é¡¹å¹¶åˆ›å»ºè™šæ‹Ÿå±å¹• ğŸ”½

ç¬¬ä¸€æ­¥æ˜¯å®‰è£…ä¾èµ–é¡¹ï¼Œæˆ‘ä»¬å°†å®‰è£…å¤šä¸ªä¾èµ–é¡¹ã€‚

- `gymnasium[box2d]`ï¼šåŒ…å«LunarLander-v2ç¯å¢ƒğŸŒ›
- `stable-baselines3[extra]`ï¼šæ·±åº¦å¼ºåŒ–å­¦ä¹ åº“ã€‚
- `huggingface_sb3`ï¼šStable-baselines3çš„é™„åŠ ä»£ç ï¼Œç”¨äºä»Hugging FaceğŸ¤—HubåŠ è½½å’Œä¸Šä¼ æ¨¡å‹ã€‚

ä¸ºäº†æ›´è½»æ¾ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªè„šæœ¬æ¥å®‰è£…æ‰€æœ‰è¿™äº›ä¾èµ–é¡¹ã€‚

```bash
apt install swig cmake
```

```bash
pip install -r https://raw.githubusercontent.com/huggingface/deep-rl-class/main/notebooks/unit1/requirements-unit1.txt
```

åœ¨ç¬”è®°æœ¬ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ªå›æ”¾è§†é¢‘ã€‚ä¸ºæ­¤ï¼Œä½¿ç”¨colabï¼Œ**æˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªè™šæ‹Ÿå±å¹•æ¥æ¸²æŸ“ç¯å¢ƒ**ï¼ˆä»è€Œè®°å½•å¸§ï¼‰ã€‚

å› æ­¤ï¼Œä»¥ä¸‹å•å…ƒæ ¼å°†å®‰è£…è™šæ‹Ÿå±å¹•åº“å¹¶åˆ›å»ºå’Œè¿è¡Œè™šæ‹Ÿå±å¹•ğŸ–¥

```bash
sudo apt-get update
apt install python3-opengl
apt install ffmpeg
apt install xvfb
pip3 install pyvirtualdisplay
```

ä¸ºäº†ç¡®ä¿æ–°å®‰è£…çš„åº“è¢«ä½¿ç”¨ï¼Œ**æœ‰æ—¶éœ€è¦é‡æ–°å¯åŠ¨ç¬”è®°æœ¬è¿è¡Œæ—¶**ã€‚ä¸‹ä¸€ä¸ªå•å…ƒæ ¼å°†å¼ºåˆ¶**è¿è¡Œæ—¶å´©æºƒï¼Œå› æ­¤ä½ éœ€è¦é‡æ–°è¿æ¥å¹¶ä»è¿™é‡Œå¼€å§‹è¿è¡Œä»£ç **ã€‚æ„Ÿè°¢è¿™ä¸ªæŠ€å·§ï¼Œ**æˆ‘ä»¬å°†èƒ½å¤Ÿè¿è¡Œæˆ‘ä»¬çš„è™šæ‹Ÿå±å¹•**ã€‚

```python
import os

os.kill(os.getpid(), 9)
```

```python
# Virtual display
from pyvirtualdisplay import Display

virtual_display = Display(visible=0, size=(1400, 900))
virtual_display.start()
```

## å¯¼å…¥åŒ… ğŸ“¦

ä¸€ä¸ªé™„åŠ åº“æˆ‘ä»¬å¯¼å…¥æ˜¯huggingface_hub**ä»¥ä¾¿èƒ½å¤Ÿä»hubä¸Šä¼ å’Œä¸‹è½½è®­ç»ƒå¥½çš„æ¨¡å‹**ã€‚


Hugging Face Hub ğŸ¤— ä½œä¸ºä¸€ä¸ªä¸­å¿ƒå¹³å°ï¼Œä»»ä½•äººéƒ½å¯ä»¥åœ¨è¿™é‡Œåˆ†äº«å’Œæ¢ç´¢æ¨¡å‹å’Œæ•°æ®é›†ã€‚å®ƒå…·æœ‰ç‰ˆæœ¬æ§åˆ¶ã€æŒ‡æ ‡ã€å¯è§†åŒ–å’Œå…¶ä»–åŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½å°†ä½¿ä½ èƒ½å¤Ÿè½»æ¾åœ°ä¸ä»–äººåä½œã€‚

ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹æ‰€æœ‰å¯ç”¨çš„æ·±åº¦å¼ºåŒ–å­¦ä¹ æ¨¡å‹ğŸ‘‰ https://huggingface.co/models?pipeline_tag=reinforcement-learning&sort=downloads

ğŸ‹ åŒ…å«æˆ‘ä»¬ç¯å¢ƒçš„åº“å«åšGymnasiumã€‚
**ä½ å°†åœ¨æ·±åº¦å¼ºåŒ–å­¦ä¹ ä¸­å¤§é‡ä½¿ç”¨Gymnasiumã€‚**

Gymnasiumæ˜¯**Gymåº“çš„æ–°ç‰ˆæœ¬**ï¼Œ[ç”±FaramaåŸºé‡‘ä¼šç»´æŠ¤](https://farama.org/)ã€‚

```python
import gymnasium

from huggingface_sb3 import load_from_hub, package_to_hub
from huggingface_hub import (
    notebook_login,
)  # To log to our Hugging Face account to be able to upload models to the Hub.

from stable_baselines3 import PPO
from stable_baselines3.common.env_util import make_vec_env
from stable_baselines3.common.evaluation import evaluate_policy
from stable_baselines3.common.monitor import Monitor
```

## äº†è§£GymnasiumåŠå…¶å·¥ä½œåŸç† ğŸ¤–

ğŸ‹ åŒ…å«æˆ‘ä»¬ç¯å¢ƒçš„åº“å«åšGymnasiumã€‚
**ä½ å°†åœ¨æ·±åº¦å¼ºåŒ–å­¦ä¹ ä¸­å¤§é‡ä½¿ç”¨Gymnasiumã€‚**

Gymnasiumæ˜¯**Gymåº“çš„æ–°ç‰ˆæœ¬**ï¼Œ[ç”±FaramaåŸºé‡‘ä¼šç»´æŠ¤](https://farama.org/)ã€‚

Gymnasiumåº“æä¾›ä¸¤ä»¶äº‹ï¼š

- ä¸€ä¸ªå…è®¸ä½ **åˆ›å»ºå¼ºåŒ–å­¦ä¹ ç¯å¢ƒ**çš„æ¥å£ã€‚
- ä¸€ä¸ª**ç¯å¢ƒé›†åˆ**ï¼ˆgym-controlã€atariã€box2Dç­‰ï¼‰ã€‚

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼Œä½†é¦–å…ˆè®©æˆ‘ä»¬å›é¡¾ä¸€ä¸‹å¼ºåŒ–å­¦ä¹ å¾ªç¯ã€‚

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/RL_process_game.jpg" alt="å¼ºåŒ–å­¦ä¹ è¿‡ç¨‹" width="100%" />

åœ¨æ¯ä¸€æ­¥ï¼š
- æˆ‘ä»¬çš„æ™ºèƒ½ä½“ä»**ç¯å¢ƒ**æ¥æ”¶ä¸€ä¸ª**çŠ¶æ€ï¼ˆS0ï¼‰**â€”â€”æˆ‘ä»¬æ¥æ”¶æ¸¸æˆçš„ç¬¬ä¸€å¸§ï¼ˆç¯å¢ƒï¼‰ã€‚
- åŸºäºè¯¥**çŠ¶æ€ï¼ˆS0ï¼‰**ï¼Œæ™ºèƒ½ä½“é‡‡å–ä¸€ä¸ª**åŠ¨ä½œï¼ˆA0ï¼‰**â€”â€”æˆ‘ä»¬çš„æ™ºèƒ½ä½“å°†å‘å³ç§»åŠ¨ã€‚
- ç¯å¢ƒè½¬æ¢åˆ°ä¸€ä¸ª**æ–°çŠ¶æ€ï¼ˆS1ï¼‰**â€”â€”æ–°çš„å¸§ã€‚
- ç¯å¢ƒç»™æ™ºèƒ½ä½“ä¸€äº›**å¥–åŠ±ï¼ˆR1ï¼‰**â€”â€”æˆ‘ä»¬æ²¡æœ‰æ­»äº¡*ï¼ˆæ­£å¥–åŠ±+1ï¼‰*ã€‚


ä½¿ç”¨Gymnasiumï¼š

1ï¸âƒ£ æˆ‘ä»¬ä½¿ç”¨`gymnasium.make()`åˆ›å»ºæˆ‘ä»¬çš„ç¯å¢ƒ

2ï¸âƒ£ æˆ‘ä»¬ä½¿ç”¨`observation = env.reset()`å°†ç¯å¢ƒé‡ç½®ä¸ºå…¶åˆå§‹çŠ¶æ€

åœ¨æ¯ä¸€æ­¥ï¼š

3ï¸âƒ£ ä½¿ç”¨æˆ‘ä»¬çš„æ¨¡å‹è·å–ä¸€ä¸ªåŠ¨ä½œï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é‡‡å–ä¸€ä¸ªéšæœºåŠ¨ä½œï¼‰

4ï¸âƒ£ ä½¿ç”¨`env.step(action)`ï¼Œæˆ‘ä»¬åœ¨ç¯å¢ƒä¸­æ‰§è¡Œè¿™ä¸ªåŠ¨ä½œå¹¶è·å¾—
- `observation`ï¼šæ–°çš„çŠ¶æ€ï¼ˆst+1ï¼‰
- `reward`ï¼šæ‰§è¡ŒåŠ¨ä½œåè·å¾—çš„å¥–åŠ±
- `terminated`ï¼šè¡¨ç¤ºå‰§é›†æ˜¯å¦ç»ˆæ­¢ï¼ˆæ™ºèƒ½ä½“è¾¾åˆ°ç»ˆæ­¢çŠ¶æ€ï¼‰
- `truncated`ï¼šåœ¨è¿™ä¸ªæ–°ç‰ˆæœ¬ä¸­å¼•å…¥ï¼Œè¡¨ç¤ºæ—¶é—´é™åˆ¶æˆ–è€…æ™ºèƒ½ä½“æ˜¯å¦è¶…å‡ºç¯å¢ƒè¾¹ç•Œç­‰æƒ…å†µã€‚
- `info`ï¼šæä¾›é¢å¤–ä¿¡æ¯çš„å­—å…¸ï¼ˆå–å†³äºç¯å¢ƒï¼‰ã€‚

æ›´å¤šè§£é‡Šè¯·æŸ¥çœ‹è¿™é‡Œ ğŸ‘‰ https://gymnasium.farama.org/api/env/#gymnasium.Env.step

å¦‚æœå‰§é›†ç»ˆæ­¢ï¼š
- æˆ‘ä»¬ä½¿ç”¨`observation = env.reset()`å°†ç¯å¢ƒé‡ç½®ä¸ºå…¶åˆå§‹çŠ¶æ€

**è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªä¾‹å­ï¼** ç¡®ä¿é˜…è¯»ä»£ç 


```python
import gymnasium as gym

# First, we create our environment called LunarLander-v2
env = gym.make("LunarLander-v2")

# Then we reset this environment
observation, info = env.reset()

for _ in range(20):
    # Take a random action
    action = env.action_space.sample()
    print("Action taken:", action)

    # Do this action in the environment and get
    # next_state, reward, terminated, truncated and info
    observation, reward, terminated, truncated, info = env.step(action)

    # If the game is terminated (in our case we land, crashed) or truncated (timeout)
    if terminated or truncated:
        # Reset the environment
        print("Environment is reset")
        observation, info = env.reset()

env.close()
```

## åˆ›å»ºæœˆçƒç€é™†å™¨ç¯å¢ƒ ğŸŒ› å¹¶äº†è§£å®ƒå¦‚ä½•å·¥ä½œ

### ç¯å¢ƒ ğŸ®

åœ¨è¿™ç¬¬ä¸€ä¸ªæ•™ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†è®­ç»ƒæˆ‘ä»¬çš„æ™ºèƒ½ä½“ï¼Œä¸€ä¸ª[æœˆçƒç€é™†å™¨](https://gymnasium.farama.org/environments/box2d/lunar_lander/)ï¼Œ**åœ¨æœˆçƒä¸Šæ­£ç¡®ç€é™†**ã€‚ä¸ºæ­¤ï¼Œæ™ºèƒ½ä½“éœ€è¦å­¦ä¹ **è°ƒæ•´å…¶é€Ÿåº¦å’Œä½ç½®ï¼ˆæ°´å¹³ã€å‚ç›´å’Œè§’åº¦ï¼‰ä»¥æ­£ç¡®ç€é™†ã€‚**

---


ğŸ’¡ å½“ä½ å¼€å§‹ä½¿ç”¨ä¸€ä¸ªç¯å¢ƒæ—¶ï¼Œä¸€ä¸ªå¥½ä¹ æƒ¯æ˜¯æŸ¥çœ‹å…¶æ–‡æ¡£ 

ğŸ‘‰ https://gymnasium.farama.org/environments/box2d/lunar_lander/

---


è®©æˆ‘ä»¬çœ‹çœ‹ç¯å¢ƒæ˜¯ä»€ä¹ˆæ ·å­ï¼š


```python
# We create our environment with gym.make("<name_of_the_environment>")
env = gym.make("LunarLander-v2")
env.reset()
print("_____OBSERVATION SPACE_____ \n")
print("Observation Space Shape", env.observation_space.shape)
print("Sample observation", env.observation_space.sample())  # Get a random observation
```

æˆ‘ä»¬å‘ç°`Observation Space Shape (8,)`ï¼Œè§‚å¯Ÿæ˜¯ä¸€ä¸ªå¤§å°ä¸º8çš„å‘é‡ï¼Œå…¶ä¸­æ¯ä¸ªå€¼åŒ…å«ä¸åŒçš„ä¿¡æ¯ï¼š
- æ°´å¹³æ¿åæ ‡ï¼ˆxï¼‰
- å‚ç›´æ¿åæ ‡ï¼ˆyï¼‰
- æ°´å¹³é€Ÿåº¦ï¼ˆxï¼‰
- å‚ç›´é€Ÿåº¦ï¼ˆyï¼‰
- è§’åº¦
- è§’é€Ÿåº¦
- å¦‚æœå·¦è…¿æ¥è§¦ç‚¹æ¥è§¦åœ°é¢ï¼ˆå¸ƒå°”å€¼ï¼‰
- å¦‚æœå³è…¿æ¥è§¦ç‚¹æ¥è§¦åœ°é¢ï¼ˆå¸ƒå°”å€¼ï¼‰


```python
print("\n _____ACTION SPACE_____ \n")
print("Action Space Shape", env.action_space.n)
print("Action Space Sample", env.action_space.sample())  # Take a random action
```

åŠ¨ä½œç©ºé—´ï¼ˆæ™ºèƒ½ä½“å¯ä»¥é‡‡å–çš„å¯èƒ½åŠ¨ä½œé›†ï¼‰æ˜¯ç¦»æ•£çš„ï¼Œæœ‰4ä¸ªå¯ç”¨åŠ¨ä½œğŸ®ï¼š

- åŠ¨ä½œ0ï¼šä»€ä¹ˆéƒ½ä¸åšï¼Œ
- åŠ¨ä½œ1ï¼šå¼€å·¦æ–¹å‘å¼•æ“ï¼Œ
- åŠ¨ä½œ2ï¼šå¼€ä¸»å¼•æ“ï¼Œ
- åŠ¨ä½œ3ï¼šå¼€å³æ–¹å‘å¼•æ“ã€‚

å¥–åŠ±å‡½æ•°ï¼ˆåœ¨æ¯ä¸ªæ—¶é—´æ­¥ç»™äºˆå¥–åŠ±çš„å‡½æ•°ï¼‰ï¼š

æ¯ä¸€æ­¥éƒ½ä¼šæˆäºˆå¥–åŠ±ã€‚ä¸€ä¸ªå‰§é›†çš„æ€»å¥–åŠ±æ˜¯**è¯¥å‰§é›†ä¸­æ‰€æœ‰æ­¥éª¤çš„å¥–åŠ±ä¹‹å’Œ**ã€‚

å¯¹äºæ¯ä¸€æ­¥ï¼Œå¥–åŠ±ï¼š

- å¦‚æœç€é™†å™¨ä¸ç€é™†æ¿æ›´æ¥è¿‘/æ›´è¿œï¼Œåˆ™å¢åŠ /å‡å°‘ã€‚
- å¦‚æœç€é™†å™¨ç§»åŠ¨å¾—æ›´æ…¢/æ›´å¿«ï¼Œåˆ™å¢åŠ /å‡å°‘ã€‚
- å¦‚æœç€é™†å™¨å€¾æ–œï¼ˆè§’åº¦ä¸æ˜¯æ°´å¹³ï¼‰ï¼Œåˆ™å‡å°‘ã€‚
- å¦‚æœæ¯æ¡è…¿éƒ½æ¥è§¦åœ°é¢ï¼Œåˆ™æ¯æ¡è…¿å¢åŠ 10åˆ†ã€‚
- å¦‚æœæ¯å¸§ä¾§å¼•æ“ç‚¹ç«ï¼Œåˆ™æ¯å¸§å‡å°‘0.03åˆ†ã€‚
- å¦‚æœæ¯å¸§ä¸»å¼•æ“ç‚¹ç«ï¼Œåˆ™æ¯å¸§å‡å°‘0.3åˆ†ã€‚

è¯¥å‰§é›†å°†æ”¶åˆ°**é¢å¤–å¥–åŠ±-100æˆ–+100åˆ†ï¼Œä»¥åˆ†åˆ«å› å æ¯æˆ–å®‰å…¨ç€é™†è€Œç»“æŸ**ã€‚

ä¸€ä¸ªå‰§é›†è¢«**è®¤ä¸ºæ˜¯ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼Œå¦‚æœå®ƒå¾—åˆ†è‡³å°‘200åˆ†**ã€‚

#### Vectorized Environment

- æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‘é‡åŒ–ç¯å¢ƒï¼ˆä¸€ç§å°†å¤šä¸ªç‹¬ç«‹ç¯å¢ƒå †å åˆ°ä¸€ä¸ªç¯å¢ƒä¸­çš„æ–¹æ³•ï¼‰ï¼Œè¿™æ ·**æˆ‘ä»¬å°†åœ¨è®­ç»ƒæœŸé—´æ‹¥æœ‰æ›´å¤šå¤šæ ·åŒ–çš„ä½“éªŒ**ã€‚

```python
# Create the environment
env = make_vec_env("LunarLander-v2", n_envs=16)
```

## Create the Model ğŸ¤–

- æˆ‘ä»¬å·²ç»ç ”ç©¶äº†æˆ‘ä»¬çš„ç¯å¢ƒï¼Œå¹¶ä¸”ç†è§£äº†é—®é¢˜ï¼šèƒ½å¤Ÿé€šè¿‡æ§åˆ¶å·¦ã€å³å’Œä¸»æ–¹å‘å¼•æ“æ­£ç¡®åœ°å°†æœˆçƒç€é™†å™¨é™è½åˆ°ç€é™†æ¿ä¸Šã€‚ç°åœ¨è®©æˆ‘ä»¬æ„å»ºæˆ‘ä»¬å°†ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ç®—æ³• ğŸš€.

- æˆ‘ä»¬å·²ç»ç ”ç©¶äº†æˆ‘ä»¬çš„ç¯å¢ƒå¹¶ç†è§£äº†é—®é¢˜ï¼š**èƒ½å¤Ÿé€šè¿‡æ§åˆ¶å·¦ã€å³å’Œä¸»æ–¹å‘å¼•æ“æ¥æ­£ç¡®åœ°åœ¨æœˆçƒä¸Šç€é™†**ã€‚ç°åœ¨è®©æˆ‘ä»¬æ„å»ºæˆ‘ä»¬å°†ä½¿ç”¨çš„ç®—æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ğŸš€ã€‚

- ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ åº“ï¼Œ[Stable Baselines3 (SB3)](https://stable-baselines3.readthedocs.io/en/master/)ã€‚

- SB3æ˜¯ä¸€ç»„**å¯é çš„PyTorchå¼ºåŒ–å­¦ä¹ ç®—æ³•å®ç°**ã€‚

ğŸ’¡ å½“ä½ ä½¿ç”¨æ–°åº“æ—¶ï¼Œé¦–å…ˆæŸ¥çœ‹æ–‡æ¡£æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ï¼šhttps://stable-baselines3.readthedocs.io/en/master/ and then try some tutorials.

----

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/unit1/sb3.png" alt="Stable Baselines3" />

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨SB3 **PPO**ã€‚[PPO (aka Proximal Policy Optimization) is one of the SOTA (state of the art) Deep Reinforcement Learning algorithms that you'll study during this course](https://stable-baselines3.readthedocs.io/en/master/modules/ppo.html#example%5D).

PPOæ˜¯ä¸€ç§ç»„åˆï¼š
- *åŸºäºä»·å€¼çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•*ï¼šå­¦ä¹ ä¸€ä¸ªåŠ¨ä½œ-ä»·å€¼å‡½æ•°ï¼Œå‘Šè¯‰æˆ‘ä»¬**åœ¨ç»™å®šçŠ¶æ€å’ŒåŠ¨ä½œä¸‹æœ€æœ‰ä»·å€¼çš„åŠ¨ä½œ**ã€‚
- *åŸºäºç­–ç•¥çš„å¼ºåŒ–å­¦ä¹ æ–¹æ³•*ï¼šå­¦ä¹ ä¸€ä¸ªç­–ç•¥ï¼Œ**ç»™æˆ‘ä»¬ä¸€ä¸ªåŠ¨ä½œçš„æ¦‚ç‡åˆ†å¸ƒ**ã€‚

Stable-Baselines3è®¾ç½®èµ·æ¥å¾ˆç®€å•ï¼š

1ï¸âƒ£ ä½ **åˆ›å»ºä½ çš„ç¯å¢ƒ**ï¼ˆåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™å·²ç»åœ¨ä¸Šé¢å®Œæˆäº†ï¼‰

2ï¸âƒ£ ä½ å®šä¹‰**ä½ æƒ³è¦ä½¿ç”¨çš„æ¨¡å‹å¹¶å®ä¾‹åŒ–è¿™ä¸ªæ¨¡å‹** `model = PPO("MlpPolicy")`

3ï¸âƒ£ ä½ ç”¨`model.learn`**è®­ç»ƒæ™ºèƒ½ä½“**å¹¶å®šä¹‰è®­ç»ƒæ—¶é—´æ­¥æ•°

```
# Create environment
env = gym.make('LunarLander-v2')

# Instantiate the agent
model = PPO('MlpPolicy', env, verbose=1)
# Train the agent
model.learn(total_timesteps=int(2e5))
```



```python
# TODO: Define a PPO MlpPolicy architecture
# We use MultiLayerPerceptron (MLPPolicy) because the input is a vector,
# if we had frames as input we would use CnnPolicy
model =
```

#### Solution

```python
# SOLUTION
# We added some parameters to accelerate the training
model = PPO(
    policy="MlpPolicy",
    env=env,
    n_steps=1024,
    batch_size=64,
    n_epochs=4,
    gamma=0.999,
    gae_lambda=0.98,
    ent_coef=0.01,
    verbose=1,
)
```

## è®­ç»ƒPPOæ™ºèƒ½ä½“ ğŸƒ
- è®©æˆ‘ä»¬è®­ç»ƒæˆ‘ä»¬çš„æ™ºèƒ½ä½“1,000,000ä¸ªæ—¶é—´æ­¥ï¼Œä¸è¦å¿˜è®°åœ¨Colabä¸Šä½¿ç”¨GPUã€‚è¿™å°†èŠ±è´¹å¤§çº¦~20åˆ†é’Ÿï¼Œä½†å¦‚æœä½ åªæ˜¯æƒ³å°è¯•ä¸€ä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨æ›´å°‘çš„æ—¶é—´æ­¥ã€‚
- åœ¨è®­ç»ƒæœŸé—´ï¼Œä¼‘æ¯ä¸€ä¸‹ï¼Œå–æ¯â˜•ï¼Œä½ åº”å¾—çš„ ğŸ¤—

```python
# TODO: Train it for 1,000,000 timesteps

# TODO: Specify file name for model and save the model to file
model_name = "ppo-LunarLander-v2"
```

#### Solution

```python
# SOLUTION
# Train it for 1,000,000 timesteps
model.learn(total_timesteps=1000000)
# Save the model
model_name = "ppo-LunarLander-v2"
model.save(model_name)
```

## è¯„ä¼°æ™ºèƒ½ä½“ ğŸ“ˆ

- è®°å¾—ç”¨[Monitor](https://stable-baselines3.readthedocs.io/en/master/common/monitor.html)åŒ…è£…ç¯å¢ƒã€‚
- ç°åœ¨æˆ‘ä»¬çš„æœˆçƒç€é™†å™¨æ™ºèƒ½ä½“å·²ç»è®­ç»ƒå¥½äº† ğŸš€ï¼Œæˆ‘ä»¬éœ€è¦**æ£€æŸ¥å®ƒçš„æ€§èƒ½**ã€‚
- Stable-Baselines3æä¾›äº†ä¸€ä¸ªæ–¹æ³•æ¥åšè¿™ä¸ªï¼š`evaluate_policy`ã€‚
- è¦å¡«å†™è¿™éƒ¨åˆ†ï¼Œä½ éœ€è¦[æŸ¥çœ‹æ–‡æ¡£](https://stable-baselines3.readthedocs.io/en/master/guide/examples.html#basic-usage-training-saving-loading)
- åœ¨ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°**å¦‚ä½•è‡ªåŠ¨è¯„ä¼°å¹¶åˆ†äº«ä½ çš„æ™ºèƒ½ä½“ä»¥åœ¨æ’è¡Œæ¦œä¸Šç«äº‰ï¼Œä½†ç°åœ¨è®©æˆ‘ä»¬è‡ªå·±æ¥åš**


ğŸ’¡ å½“ä½ è¯„ä¼°ä½ çš„æ™ºèƒ½ä½“æ—¶ï¼Œä½ ä¸åº”è¯¥ä½¿ç”¨ä½ çš„è®­ç»ƒç¯å¢ƒï¼Œè€Œæ˜¯åˆ›å»ºä¸€ä¸ªè¯„ä¼°ç¯å¢ƒã€‚

```python
# TODO: Evaluate the agent
# Create a new environment for evaluation
eval_env =

# Evaluate the model with 10 evaluation episodes and deterministic=True
mean_reward, std_reward = 

# Print the results
```

#### Solution

```python
# @title
eval_env = Monitor(gym.make("LunarLander-v2"))
mean_reward, std_reward = evaluate_policy(model, eval_env, n_eval_episodes=10, deterministic=True)
print(f"mean_reward={mean_reward:.2f} +/- {std_reward}")
```

- åœ¨æˆ‘çš„ä¾‹å­ä¸­ï¼Œæˆ‘åœ¨è®­ç»ƒ100ä¸‡æ­¥åå¾—åˆ°äº†`200.20 +/- 20.80`çš„å¹³å‡å¥–åŠ±ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„æœˆçƒç€é™†å™¨æ™ºèƒ½ä½“å·²ç»å‡†å¤‡å¥½ç™»é™†æœˆçƒäº† ğŸŒ›ğŸ¥³ã€‚

## åœ¨Hubä¸Šå‘å¸ƒæˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹ ğŸ”¥
ç°åœ¨æˆ‘ä»¬çœ‹åˆ°è®­ç»ƒåå¾—åˆ°äº†å¥½çš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€è¡Œä»£ç å°†æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹å‘å¸ƒåˆ°hub ğŸ¤— ä¸Šã€‚

ğŸ“š åº“æ–‡æ¡£ ğŸ‘‰ https://github.com/huggingface/huggingface_sb3/tree/main#hugging-face--x-stable-baselines3-v20

è¿™é‡Œæ˜¯ä¸€ä¸ªæ¨¡å‹å¡ç‰‡çš„ä¾‹å­ï¼ˆä½¿ç”¨å¤ªç©ºå…¥ä¾µè€…ï¼‰ï¼š

é€šè¿‡ä½¿ç”¨`package_to_hub`ï¼Œ**ä½ å¯ä»¥è¯„ä¼°ã€è®°å½•å›æ”¾ã€ç”Ÿæˆä½ çš„æ™ºèƒ½ä½“çš„æ¨¡å‹å¡ç‰‡å¹¶å°†å…¶æ¨é€åˆ°hub**ã€‚

è¿™æ ·ï¼š
- ä½ å¯ä»¥**å±•ç¤ºæˆ‘ä»¬çš„å·¥ä½œ** ğŸ”¥
- ä½ å¯ä»¥**å¯è§†åŒ–ä½ çš„æ™ºèƒ½ä½“çš„æ¸¸æˆè¿‡ç¨‹** ğŸ‘€
- ä½ å¯ä»¥**ä¸ç¤¾åŒºåˆ†äº«ä¸€ä¸ªå…¶ä»–äººå¯ä»¥ä½¿ç”¨çš„æ™ºèƒ½ä½“** ğŸ’¾
- ä½ å¯ä»¥**è®¿é—®ä¸€ä¸ªæ’è¡Œæ¦œ ğŸ† æ¥çœ‹çœ‹ä½ çš„æ™ºèƒ½ä½“ä¸ä½ çš„åŒå­¦ç›¸æ¯”è¡¨ç°å¦‚ä½•** ğŸ‘‰ https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard


è¦èƒ½å¤Ÿä¸ç¤¾åŒºåˆ†äº«ä½ çš„æ¨¡å‹ï¼Œè¿˜æœ‰ä¸‰ä¸ªæ­¥éª¤éœ€è¦éµå¾ªï¼š

1ï¸âƒ£ ï¼ˆå¦‚æœè¿˜æ²¡æœ‰å®Œæˆï¼‰åœ¨Hugging Faceä¸Šåˆ›å»ºä¸€ä¸ªè´¦æˆ· â¡ https://huggingface.co/join

2ï¸âƒ£ ç™»å½•ï¼Œç„¶åï¼Œä½ éœ€è¦ä»Hugging Faceç½‘ç«™å­˜å‚¨ä½ çš„è®¤è¯ä»¤ç‰Œã€‚
- åˆ›å»ºä¸€ä¸ªæ–°çš„ä»¤ç‰Œï¼ˆhttps://huggingface.co/settings/tokensï¼‰**å…·æœ‰å†™å…¥è§’è‰²**

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/create-token.jpg" alt="åˆ›å»ºHFä»¤ç‰Œ" />

- å¤åˆ¶ä»¤ç‰Œ
- è¿è¡Œä¸‹é¢çš„å•å…ƒæ ¼å¹¶ç²˜è´´ä»¤ç‰Œ

```python
notebook_login()
!git config --global credential.helper store
```

å¦‚æœä½ ä¸æƒ³ä½¿ç”¨Google Colabæˆ–Jupyter Notebookï¼Œä½ éœ€è¦ä½¿ç”¨è¿™ä¸ªå‘½ä»¤ï¼š`huggingface-cli login`

3ï¸âƒ£ æˆ‘ä»¬ç°åœ¨å‡†å¤‡ä½¿ç”¨`package_to_hub()`å‡½æ•°å°†æˆ‘ä»¬è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“æ¨é€åˆ°ğŸ¤— Hub ğŸ”¥

è®©æˆ‘ä»¬å¡«å†™`package_to_hub`å‡½æ•°ï¼š
- `model`ï¼šæˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹ã€‚
- `model_name`ï¼šæˆ‘ä»¬åœ¨`model_save`ä¸­å®šä¹‰çš„è®­ç»ƒæ¨¡å‹çš„åç§°
- `model_architecture`ï¼šæˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å‹æ¶æ„ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯PPO
- `env_id`ï¼šç¯å¢ƒçš„åç§°ï¼Œåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯`LunarLander-v2`
- `eval_env`ï¼šåœ¨eval_envä¸­å®šä¹‰çš„è¯„ä¼°ç¯å¢ƒ
- `repo_id`ï¼šå°†è¦åˆ›å»º/æ›´æ–°çš„Hugging Face Hubä»“åº“çš„åç§°`(repo_id = {username}/{repo_name})`

ğŸ’¡ **ä¸€ä¸ªå¥½çš„åç§°æ˜¯`{username}/{model_architecture}-{env_id}`**

- `commit_message`ï¼šæäº¤çš„æ¶ˆæ¯

```python
import gymnasium as gym
from stable_baselines3.common.vec_env import DummyVecEnv
from stable_baselines3.common.env_util import make_vec_env

from huggingface_sb3 import package_to_hub

## TODO: å®šä¹‰ä¸€ä¸ªrepo_id
## repo_idæ˜¯Hugging Face Hubä¸Šæ¨¡å‹ä»“åº“çš„IDï¼ˆrepo_id = {ç»„ç»‡}/{ä»“åº“åç§°}ï¼Œä¾‹å¦‚ThomasSimonini/ppo-LunarLander-v2
repo_id = 

# TODO: å®šä¹‰ç¯å¢ƒçš„åç§°
env_id = 

# åˆ›å»ºè¯„ä¼°ç¯å¢ƒå¹¶è®¾ç½®render_mode="rgb_array"
eval_env = DummyVecEnv([lambda: gym.make(env_id, render_mode="rgb_array")])


# TODO: å®šä¹‰æˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å‹æ¶æ„
model_architecture = ""

## TODO: å®šä¹‰æäº¤æ¶ˆæ¯
commit_message = ""

# æ–¹æ³•ä¿å­˜ã€è¯„ä¼°ã€ç”Ÿæˆæ¨¡å‹å¡ç‰‡å¹¶åœ¨å°†ä»“åº“æ¨é€åˆ°hubä¹‹å‰è®°å½•æ™ºèƒ½ä½“çš„å›æ”¾è§†é¢‘
package_to_hub(model=model, # æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹
               model_name=model_name, # æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹çš„åç§°
               model_architecture=model_architecture, # æˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å‹æ¶æ„ï¼šåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯PPO
               env_id=env_id, # ç¯å¢ƒçš„åç§°
               eval_env=eval_env, # è¯„ä¼°ç¯å¢ƒ
               repo_id=repo_id, # Hugging Face Hubä¸Šæ¨¡å‹ä»“åº“çš„IDï¼ˆrepo_id = {ç»„ç»‡}/{ä»“åº“åç§°}ï¼Œä¾‹å¦‚ThomasSimonini/ppo-LunarLander-v2
               commit_message=commit_message)
```

#### è§£å†³æ–¹æ¡ˆ


```python
import gymnasium as gym

from stable_baselines3 import PPO
from stable_baselines3.common.vec_env import DummyVecEnv
from stable_baselines3.common.env_util import make_vec_env

from huggingface_sb3 import package_to_hub

# æ”¾ç½®ä½ åˆšåˆšåœ¨ä¸Šé¢ä¸¤ä¸ªå•å…ƒæ ¼ä¸­å®šä¹‰çš„å˜é‡
# å®šä¹‰ç¯å¢ƒçš„åç§°
env_id = "LunarLander-v2"

# TODO: å®šä¹‰æˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å‹æ¶æ„
model_architecture = "PPO"

## å®šä¹‰ä¸€ä¸ªrepo_id
## repo_idæ˜¯Hugging Face Hubä¸Šæ¨¡å‹ä»“åº“çš„IDï¼ˆrepo_id = {ç»„ç»‡}/{ä»“åº“åç§°}ï¼Œä¾‹å¦‚ThomasSimonini/ppo-LunarLander-v2
## æ›´æ”¹ä¸ºä½ çš„REPO ID
repo_id = "ThomasSimonini/ppo-LunarLander-v2"  # æ›´æ”¹ä¸ºä½ çš„repo idï¼Œä½ ä¸èƒ½ç”¨æˆ‘çš„æ¨é€ ğŸ˜„

## å®šä¹‰æäº¤æ¶ˆæ¯
commit_message = "ä¸Šä¼ PPO LunarLander-v2è®­ç»ƒå¥½çš„æ™ºèƒ½ä½“"

# åˆ›å»ºè¯„ä¼°ç¯å¢ƒå¹¶è®¾ç½®render_mode="rgb_array"
eval_env = DummyVecEnv([lambda: Monitor(gym.make(env_id, render_mode="rgb_array"))])

# åœ¨è¿™é‡Œæ”¾ç½®ä½ åˆšåˆšå¡«å†™çš„package_to_hubå‡½æ•°
package_to_hub(
    model=model,  # æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹
    model_name=model_name,  # æˆ‘ä»¬è®­ç»ƒå¥½çš„æ¨¡å‹çš„åç§°
    model_architecture=model_architecture,  # æˆ‘ä»¬ä½¿ç”¨çš„æ¨¡å‹æ¶æ„ï¼šåœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯PPO
    env_id=env_id,  # ç¯å¢ƒçš„åç§°
    eval_env=eval_env,  # è¯„ä¼°ç¯å¢ƒ
    repo_id=repo_id,  # Hugging Face Hubä¸Šæ¨¡å‹ä»“åº“çš„IDï¼ˆrepo_id = {ç»„ç»‡}/{ä»“åº“åç§°}ï¼Œä¾‹å¦‚ThomasSimonini/ppo-LunarLander-v2
    commit_message=commit_message,
)
```

æ­å–œ ğŸ¥³ ä½ åˆšåˆšè®­ç»ƒå¹¶ä¸Šä¼ äº†ä½ çš„ç¬¬ä¸€ä¸ªæ·±åº¦å¼ºåŒ–å­¦ä¹ æ™ºèƒ½ä½“ã€‚ä¸Šé¢çš„è„šæœ¬åº”è¯¥å·²ç»æ˜¾ç¤ºäº†ä¸€ä¸ªæ¨¡å‹ä»“åº“çš„é“¾æ¥ï¼Œå¦‚https://huggingface.co/osanseviero/test_sb3ã€‚å½“ä½ è®¿é—®è¿™ä¸ªé“¾æ¥æ—¶ï¼Œä½ å¯ä»¥ï¼š
* åœ¨å³ä¾§çœ‹åˆ°ä½ çš„æ™ºèƒ½ä½“çš„è§†é¢‘é¢„è§ˆã€‚
* ç‚¹å‡»"Files and versions"æŸ¥çœ‹ä»“åº“ä¸­çš„æ‰€æœ‰æ–‡ä»¶ã€‚
* ç‚¹å‡»"Use in stable-baselines3"è·å–æ˜¾ç¤ºå¦‚ä½•åŠ è½½æ¨¡å‹çš„ä»£ç ç‰‡æ®µã€‚
* ä¸€ä¸ªæ¨¡å‹å¡ç‰‡ï¼ˆ`README.md`æ–‡ä»¶ï¼‰ï¼Œæä¾›æ¨¡å‹çš„æè¿°

åœ¨åº•å±‚ï¼ŒHubä½¿ç”¨åŸºäºgitçš„ä»“åº“ï¼ˆå¦‚æœä½ ä¸çŸ¥é“gitæ˜¯ä»€ä¹ˆï¼Œä¸ç”¨æ‹…å¿ƒï¼‰ï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥åœ¨å®éªŒå’Œæ”¹è¿›ä½ çš„æ™ºèƒ½ä½“æ—¶ç”¨æ–°ç‰ˆæœ¬æ›´æ–°æ¨¡å‹ã€‚

ä½¿ç”¨æ’è¡Œæ¦œæ¯”è¾ƒä½ çš„LunarLander-v2ä¸ä½ çš„åŒå­¦çš„ç»“æœ ğŸ† ğŸ‘‰ https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard

## ä»HubåŠ è½½ä¿å­˜çš„LunarLanderæ¨¡å‹ ğŸ¤—
æ„Ÿè°¢[ironbar](https://github.com/ironbar)çš„è´¡çŒ®ã€‚

ä»HubåŠ è½½ä¿å­˜çš„æ¨¡å‹éå¸¸ç®€å•ã€‚

ä½ å¯ä»¥å‰å¾€https://huggingface.co/models?library=stable-baselines3 æŸ¥çœ‹æ‰€æœ‰ä¿å­˜çš„Stable-baselines3æ¨¡å‹çš„åˆ—è¡¨ã€‚
1. ä½ é€‰æ‹©ä¸€ä¸ªå¹¶å¤åˆ¶å…¶repo_id

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/unit1/copy-id.png" alt="å¤åˆ¶ID"/>

2. ç„¶åæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨load_from_hubï¼ŒåŒ…å«ï¼š
- repo_id
- filenameï¼šä»“åº“å†…ä¿å­˜çš„æ¨¡å‹åŠå…¶æ‰©å±•åï¼ˆ*.zipï¼‰

å› ä¸ºæˆ‘ä»Hubä¸‹è½½çš„æ¨¡å‹æ˜¯ç”¨Gymï¼ˆGymnasiumçš„å‰ä¸€ä¸ªç‰ˆæœ¬ï¼‰è®­ç»ƒçš„ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…shimmyï¼Œè¿™æ˜¯ä¸€ä¸ªAPIè½¬æ¢å·¥å…·ï¼Œå®ƒå°†å¸®åŠ©æˆ‘ä»¬æ­£ç¡®è¿è¡Œç¯å¢ƒã€‚

Shimmyæ–‡æ¡£ï¼šhttps://github.com/Farama-Foundation/Shimmy

```python
!pip install shimmy
```

```python
from huggingface_sb3 import load_from_hub

repo_id = "Classroom-workshop/assignment2-omar"  # repo_id
filename = "ppo-LunarLander-v2.zip"  # æ¨¡å‹æ–‡ä»¶å.zip

# å½“æ¨¡å‹åœ¨Python 3.8ä¸Šè®­ç»ƒæ—¶ï¼Œpickleåè®®æ˜¯5
# ä½†Python 3.6, 3.7ä½¿ç”¨åè®®4
# ä¸ºäº†è·å¾—å…¼å®¹æ€§ï¼Œæˆ‘ä»¬éœ€è¦ï¼š
# 1. å®‰è£…pickle5ï¼ˆæˆ‘ä»¬åœ¨colabå¼€å§‹æ—¶å·²ç»å®Œæˆï¼‰
# 2. åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„ç©ºå¯¹è±¡ï¼Œæˆ‘ä»¬å°†å…¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™PPO.load()
custom_objects = {
    "learning_rate": 0.0,
    "lr_schedule": lambda _: 0.0,
    "clip_range": lambda _: 0.0,
}

checkpoint = load_from_hub(repo_id, filename)
model = PPO.load(checkpoint, custom_objects=custom_objects, print_system_info=True)
```

è®©æˆ‘ä»¬è¯„ä¼°è¿™ä¸ªæ™ºèƒ½ä½“ï¼š

```python
# @title
eval_env = Monitor(gym.make("LunarLander-v2"))
mean_reward, std_reward = evaluate_policy(model, eval_env, n_eval_episodes=10, deterministic=True)
print(f"mean_reward={mean_reward:.2f} +/- {std_reward}")
```

## ä¸€äº›é¢å¤–çš„æŒ‘æˆ˜ ğŸ†
å­¦ä¹ çš„æœ€å¥½æ–¹æ³•**æ˜¯è‡ªå·±å°è¯•**ï¼æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œå½“å‰çš„æ™ºèƒ½ä½“è¡¨ç°ä¸æ˜¯å¾ˆå¥½ã€‚ä½œä¸ºç¬¬ä¸€ä¸ªå»ºè®®ï¼Œä½ å¯ä»¥è®­ç»ƒæ›´å¤šæ­¥éª¤ã€‚ä½¿ç”¨1,000,000æ­¥ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†ä¸€äº›å¾ˆå¥½çš„ç»“æœï¼

åœ¨[æ’è¡Œæ¦œ](https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard)ä¸­ï¼Œä½ ä¼šæ‰¾åˆ°ä½ çš„æ™ºèƒ½ä½“ã€‚ä½ èƒ½ç™»ä¸Šæ¦œé¦–å—ï¼Ÿ

ä»¥ä¸‹æ˜¯ä¸€äº›å®ç°è¿™ä¸€ç›®æ ‡çš„æƒ³æ³•ï¼š
* è®­ç»ƒæ›´å¤šæ­¥éª¤
* å°è¯•`PPO`çš„ä¸åŒè¶…å‚æ•°ã€‚ä½ å¯ä»¥åœ¨https://stable-baselines3.readthedocs.io/en/master/modules/ppo.html#parameters æŸ¥çœ‹å®ƒä»¬ã€‚
* æŸ¥çœ‹[Stable-Baselines3æ–‡æ¡£](https://stable-baselines3.readthedocs.io/en/master/modules/dqn.html)å¹¶å°è¯•å¦ä¸€ä¸ªæ¨¡å‹ï¼Œå¦‚DQNã€‚
* **å°†ä½ æ–°è®­ç»ƒçš„æ¨¡å‹**æ¨é€åˆ°Hub ğŸ”¥

**ä½¿ç”¨[æ’è¡Œæ¦œ](https://huggingface.co/spaces/huggingface-projects/Deep-Reinforcement-Learning-Leaderboard)æ¯”è¾ƒä½ çš„LunarLander-v2ä¸ä½ çš„åŒå­¦çš„ç»“æœ** ğŸ†

æœˆçƒç€é™†å¯¹ä½ æ¥è¯´å¤ªæ— èŠäº†å—ï¼Ÿå°è¯•**æ”¹å˜ç¯å¢ƒ**ï¼Œä¸ºä»€ä¹ˆä¸ä½¿ç”¨MountainCar-v0ã€CartPole-v1æˆ–CarRacing-v0ï¼ŸæŸ¥çœ‹å®ƒä»¬å¦‚ä½•å·¥ä½œ[ä½¿ç”¨gymæ–‡æ¡£](https://www.gymlibrary.dev/)å¹¶äº«å—ä¹è¶£ ğŸ‰ã€‚

________________________________________________________________________
æ­å–œä½ å®Œæˆæœ¬ç« ï¼è¿™æ˜¯æœ€å¤§çš„ä¸€ç« ï¼Œ**åŒ…å«äº†å¤§é‡ä¿¡æ¯ã€‚**

å¦‚æœä½ ä»ç„¶å¯¹æ‰€æœ‰è¿™äº›å…ƒç´ æ„Ÿåˆ°å›°æƒ‘...è¿™å®Œå…¨æ­£å¸¸ï¼**è¿™å¯¹æˆ‘å’Œæ‰€æœ‰å­¦ä¹ å¼ºåŒ–å­¦ä¹ çš„äººæ¥è¯´éƒ½æ˜¯ä¸€æ ·çš„ã€‚**

èŠ±æ—¶é—´çœŸæ­£**ç†è§£ææ–™ï¼Œç„¶åå†ç»§ç»­å¹¶å°è¯•é¢å¤–çš„æŒ‘æˆ˜**ã€‚æŒæ¡è¿™äº›å…ƒç´ å¹¶å»ºç«‹åšå®çš„åŸºç¡€å¾ˆé‡è¦ã€‚

å½“ç„¶ï¼Œåœ¨è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨è¿™äº›æ¦‚å¿µï¼Œä½†**åœ¨æ·±å…¥ä¸‹ä¸€ç« ä¹‹å‰ï¼Œæœ€å¥½å¯¹å®ƒä»¬æœ‰ä¸€ä¸ªè‰¯å¥½çš„ç†è§£ã€‚**


ä¸‹æ¬¡ï¼Œåœ¨å¥–åŠ±å•å…ƒ1ä¸­ï¼Œä½ å°†è®­ç»ƒHuggyç‹—å»æ¡æ‹¾æœ¨æ£ã€‚

<img src="https://huggingface.co/datasets/huggingface-deep-rl-course/course-images/resolve/main/en/notebooks/unit1/huggy.jpg" alt="Huggy" />

## ç»§ç»­å­¦ä¹ ï¼Œä¿æŒç²¾å½© ğŸ¤—
